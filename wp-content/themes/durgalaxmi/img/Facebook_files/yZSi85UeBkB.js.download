;/*FB_PKG_DELIM*/

__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return d[0]=new c.Map(),d[0].set("bump_timestamp_ms",a[1]),d[0].set("thread_key",a[0]),d[0].set("bumped_by_local_device_send",a[2]),d[1]=d[0].get("thread_key"),d[0],c.sp(b("LSCancelTaskByQueueName"),c.i64.to_string(d[1]),[0,389])},function(e){return d[2]=new c.Map(),d[2].set("bump_timestamp_ms",a[1]),d[2].set("thread_key",a[0]),d[2].set("bumped_by_local_device_send",a[2]),d[3]=d[2].get("thread_key"),d[2],d[4]=c.toJSON(d[2]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[3]),[0,389],d[4],f,f,[0,0],[0,0],f,f,[0,0])}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSCreateE2EEMetadataThread",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("wa_jid",a[0]),d[0].set("offline_thread_key",a[1]),d[0].set("thread_type",a[2]),d[0].set("folder_type",a[3]),d[0].set("bump_timestamp_ms",a[4]),d[1]=d[0].get("offline_thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[1]),[0,388],d[2],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[1]),[0,394],d[2],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("MAWCatQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4877036382414550"}),null);
__d("MAWCatQuery.facebook.graphql",["MAWCatQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SecureMessageOverWACATGraphResult",kind:"LinkedField",name:"secure_message_over_wa_cat_query",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_serialized_cat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiration_time_in_seconds",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWCatQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MAWCatQuery",selections:a},params:{id:b("MAWCatQuery_facebookRelayOperation"),metadata:{},name:"MAWCatQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MAWCatQuery.graphql",["cr:11203"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:11203")}),null);
__d("MAWCatQuery",["MAWCatQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("MAWCatQuery.graphql");c=a;g["default"]=c}),98);
__d("MWToast.react",["deferredLoadComponent","gkx","react","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("gkx")("571"),j=c("deferredLoadComponent")(c("requireDeferred")("MDSToast.react").__setRef("MWToast.react")),k=c("deferredLoadComponent")(c("requireDeferred")("CometToast.react").__setRef("MWToast.react"));function a(a){var b,c=a.body,d=a.icon,e=a.onDismiss,f=a.startAddOn;f=f===void 0?null:f;var g=a.supressCloseButton;g=g===void 0?!1:g;var l=a.testid;l=l===void 0?"mw-toast":l;a=a.title;var m=(d==null?void 0:d.mds)!=null?{source:d==null?void 0:d.mds,type:"icon"}:void 0;d=(d=d==null?void 0:d.comet)!=null?d:void 0;b=a!=null&&c!=null?h.jsxs(h.Fragment,{children:[a,h.jsx("br",{}),c]}):(b=(b=a)!=null?b:c)!=null?b:"";c={body:c,onDismiss:e,startAddOn:f!==null?f:m,testid:l,title:a,withCloseButton:!g};f={icon:d,message:b,onDismiss:e,supressCloseButton:g,testid:l};return i?h.jsx(j,babelHelpers["extends"]({},c)):h.jsx(k,babelHelpers["extends"]({},f))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("mwPushToast",["ix","BaseToasterStateManager","MWToast.react","cr:2344","cr:4379","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=c("BaseToasterStateManager").getInstance();function k(a,b){var d=a.body,e=a.icon,f=a.startAddOn;f=f===void 0?null:f;var g=a.supressCloseButton;g=g===void 0?!1:g;a=a.title;b===void 0&&(b=2750);var h=j.push(i.jsx(c("MWToast.react"),{body:d,icon:e,onDismiss:function(){return j.expire(h)},startAddOn:f,supressCloseButton:g,title:a}),b);return h}function a(a,c){var e,f=a.body;a=a.title;c===void 0&&(c=2750);var g=b("cr:2344")!==null?i.jsx(b("cr:2344"),{color:"warning",icon:d("fbicon")._(h("502062"),20)}):void 0;e=(e=b("cr:4379"))!=null?e:void 0;return k({body:f,icon:{comet:g,mds:e},title:a},c)}g.mwPushToast=k;g.mwPushErrorToast=a}),98);
__d("mwReplaceToast",["BaseToasterStateManager","MWToast.react","err","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("BaseToasterStateManager").getInstance();function a(a){var b=a.body,d=a.icon,e=a.startAddOn;e=e===void 0?null:e;var f=a.supressCloseButton;f=f===void 0?!1:f;var g=a.title,j=a.toastId;if(j==null){c("err")("toastId or toasterStateManager is not provided");return}i.replace(j,h.jsx(c("MWToast.react"),{body:b,icon:d,onDismiss:function(){return i.expire(j)},startAddOn:e,supressCloseButton:f,title:g}))}g.mwReplaceToast=a}),98);
__d("MAWCryptoAuthToken",["MAWCatQuery","RelayHooks","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a==null||a.secure_message_over_wa_cat_query==null||a.secure_message_over_wa_cat_query.encrypted_serialized_cat==null||a.secure_message_over_wa_cat_query.expiration_time_in_seconds==null?{error:"Crypto Auth Token was null or incomplete"}:{success:{encrypted_serialized_cat:a.secure_message_over_wa_cat_query.encrypted_serialized_cat,expiration_time_in_seconds:a.secure_message_over_wa_cat_query.expiration_time_in_seconds}}}function a(a){return d("RelayHooks").fetchQuery(a,c("MAWCatQuery"),{}).toPromise().then(h).then(function(a){if(a.error!==null&&a.error!==void 0)throw c("err")("Unable to rotate Crypto Auth Token");return a.success})}g.processCatResponse=h;g.fetchFreshCAT=a}),98);
__d("MessengerWaitForEvent",["Promise"],(function(a,b,c,d,e,f){function a(a,c,d){var e,f=d;return new(b("Promise"))(function(b){f?e=function(){f.apply(this,arguments)&&b.apply(this,arguments)}:e=b,a&&a.addEventListener&&a.addEventListener(c,e)})["finally"](function(){a&&a.removeEventListener&&a.removeEventListener(c,e)})}f.waitForEvent=a}),66);
__d("LocalStorageMutex",["MessengerWaitForEvent","Promise","QPLUserFlow","err","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=1e3;a=function(){function a(a){var b=this,d=a.mutexKey,e=a.localTakeoverKey,f=a.log,g=a.logError,h=a.getStorage,j=a.setItemGuarded,k=a.mutexTimeoutMs;k=k===void 0?i:k;a=a.mutexTimeoutCallback;this.mutexFilter=function(a){if(a.key!==b.$1)return!1;a=a.newValue||"";if(!a.includes(c("pageID")))return!0;else return!1};this.$1=d;this.$2=e;this.$5=h;this.$6=j;this.$3=f;this.$4=g;this.$7=k;this.$8=a}var e=a.prototype;e.init=function(){c("QPLUserFlow").start(c("qpl")._(1056847375,"584"));this.$3("APPMUTEX - this tab is "+c("pageID"));var a=this.getMutex();if(a!=null&&a===c("pageID")){this.$3("APPMUTEX - WE ALREADY HAVE THE MUTEX LOCK WITHIN INIT");c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return b("Promise").resolve(!0)}if(a!=null){this.$3("APPMUTEX - initiating localTAKEOVER");return this.localTakeover()}else{this.$3("APPMUTEX - NO1 ELSE IS ALIVE, GET THE MUTEX");a=this.$9(c("pageID"));var d=this.$10(c("pageID"));if(!a.success||!d.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{bool:{setMutexResult:d.success,setTakeoverResult:a.success},string:{setMutexError:d.error,setTakeoverError:a.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"fail_to_set_takeover_or_mutex");return b("Promise").resolve(!1)}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return b("Promise").resolve(!0)}};e.localTakeover=function(){var a,e=this,f=this.$9(c("pageID"));if(!f.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{initTakeoverError:f.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_init_takeover_failure");return b("Promise").resolve(!1)}var g,h=function(){g!=null&&clearTimeout(g)};f=d("MessengerWaitForEvent").waitForEvent(window,"storage",this.mutexFilter);var j=(a=this==null?void 0:this._mutexTimeoutMs)!=null?a:i;return b("Promise").race([f,new(b("Promise"))(function(a){g=setTimeout(function(){a()},j)}),this.$8?this.$8():new(b("Promise"))(function(a){})]).then(function(a){if(a==null){e.$3("AppMutex - Forcefully took the mutex and takeover lock");var b=e.$9(c("pageID")),d=e.$10(c("pageID"));if(!b.success||!d.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{setMutexError:d.error,setTakeoverError:b.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_forcefully_takeover_failure");return!1}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return!0}e.$3("APPMUTEX - GOT MUTEX STORAGE EVENT CHANGE FROM ANOTHER TAB");d=e.$11(a.newValue);if(!d&&e.hasTakeoverPermission()){e.$3("APPMUTEX - setting mutex on localtakeover");b=e.$10(c("pageID"));if(!b.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{setMutexError:b.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_set_mutex_failure");return!1}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return!0}else{e.hasTakeoverPermission()&&e.$12();c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_no_takeover_permission");return!1}}).then(function(a){h();return a})["catch"](function(a){h();e.$4("AppMutex - localTakeover error no permission - "+a);c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_general_failure");return!1})};e.onMutexDeath=function(){var a=this.getMutex();a!=null&&a==c("pageID")&&(this.$3("APPMUTEX - removing mutex on death"),this.$13(),this.hasTakeoverPermission()&&this.$12())};e.takeoverFilter=function(a){if(a.key!==this.$2)return!1;a=a.newValue||"";if(!a.includes(c("pageID")))return!0;else return!1};e.$14=function(){if(!h){var a=this.$5();if(!a)throw c("err")("Could not get localStorage");h=a}return h};e.getMutex=function(){h=this.$14();return h.getItem(this.$1)};e.$10=function(a){h=this.$14();return this.$6(h,this.$1,a)};e.$13=function(){h=this.$14(),h.removeItem(this.$1)};e.getTakeover=function(){h=this.$14();return h.getItem(this.$2)};e.$9=function(a){h=this.$14();return this.$6(h,this.$2,a)};e.$12=function(){h=this.$14(),h.removeItem(this.$2)};e.$11=function(a){return a!=null?a:""};e.hasTakeoverPermission=function(){var a=this.getTakeover();return a!=null&&a==c("pageID")};return a}();g.THIS_TAB=c("pageID");g.LocalStorageMutex=a}),98);
__d("MAWAppMutex",["LocalStorageMutex","MAWLocalStorage","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h="armadillo_msgr_mutex",i="armadillo_msgr_local_takeover",j=null;function a(){j==null&&(j=new(d("LocalStorageMutex").LocalStorageMutex)({mutexKey:h,localTakeoverKey:i,log:function(a){d("WALogger").LOG([a])},logError:function(a){d("WALogger").ERROR([a])},getStorage:d("MAWLocalStorage").getStorage,setItemGuarded:d("MAWLocalStorage").setItemGuarded}));return j}g.MAW_MUTEX_KEY=h;g.MAW_LOCALTAKEOVER_KEY=i;g.use=a}),98);
__d("MAWAckLevel.bs",["LSMessageSendStatus.bs","LSMessageSendStatusV2.bs"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.TAG){case 7:return d("LSMessageSendStatusV2.bs").sendingToServer;case 8:case 9:case 10:case 11:return d("LSMessageSendStatusV2.bs").serverReceived;default:return d("LSMessageSendStatusV2.bs").nonRetriableError}}function b(a){switch(a.TAG){case 7:return d("LSMessageSendStatus.bs").sendingToServer;case 8:case 9:case 10:case 11:return d("LSMessageSendStatus.bs").serverReceived;default:return d("LSMessageSendStatus.bs").nonRetriableError}}c={clock:0,contentGone:-3,contentTooBig:-4,contentUnuploadable:-5,expired:-2,failed:-1,inactiveReceived:-6,played:4,read:3,received:2,senderBackFillSent:-7,sent:1};g.levelToMessagingSendStatusV2=a;g.levelToMessagingSendStatus=b;g.ackVal_DO_NOT_USE=c}),98);
__d("MAWAckLevel",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a;switch(a.TAG){case 0:return-7;case 1:return-6;case 2:return-5;case 3:return-4;case 4:return-3;case 5:return-2;case 6:return-1;case 7:return 0;case 8:return 1;case 9:return 2;case 10:return 3;case 11:return 4}}function b(a){var b=null;switch(a){case-7:b=0;break;case-6:b=1;break;case-5:b=2;break;case-4:b=3;break;case-3:b=4;break;case-2:b=5;break;case-1:b=6;break;case 0:b=7;break;case 1:b=8;break;case 2:b=9;break;case 3:b=10;break;case 4:b=11;break}return{_0:void 0,TAG:b}}f.ackLevelToJS=a;f.ackLevelToRE=b}),66);
__d("MAWLocalizationEphemeralSettingSetAdminMsg",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF}g.isEphemeralSettingSetAdminMsg=a}),98);
__d("MAWLocalizationEphemeralSettingSetAdminMsg.bs",["MAWLocalizationEphemeralSettingSetAdminMsg"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a)}g.isEphemeralSettingSetAdminMsg=a}),98);
__d("MAWAdminMsgCTA.bs",["fbt","MAWLocalizationEphemeralSettingSetAdminMsg.bs","MAWLocalizationType.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g,h){"use strict";var i=h._("__JHASH__iw7A0LnsmaW__JHASH__").toString(),j=h._("__JHASH__jODYJ2eW1Pa__JHASH__").toString(),k=h._("__JHASH__xAOSvpC7vLN__JHASH__").toString();function l(a){return d("ReQL.bs").first(d("ReQL.bs").fromIndexDescending(a.table("admin_message_ctas").index("ctaId"))).then(function(a){if(a!==void 0)return c("bs_caml_int64").add(a.ctaId,c("bs_caml_int64").one);else return c("bs_caml_int64").zero})}function m(a,b,c){return d("ReQL.bs").first(d("ReQL.bs").bounds(d("ReQL.bs").fromTableDescending(a.table("admin_message_ctas")),{NAME:"range",VAL:[{NAME:"greaterThanOrEqual",VAL:{hd:b,tl:{hd:c,tl:0}}},{NAME:"lessThanOrEqual",VAL:{hd:b,tl:{hd:c,tl:0}}}]})).then(function(a){return a})}function n(a){if(a!==void 0)if(d("MAWLocalizationEphemeralSettingSetAdminMsg.bs").isEphemeralSettingSetAdminMsg(a))return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:i};else if(a===d("MAWLocalizationType.bs").cutoverThreadAdminMessage||a===d("MAWLocalizationType.bs").e2eeThreadAdminMessage)return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:j};else if(a===d("MAWLocalizationType.bs").cutoverRollbackAdminMessage)return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:k};else return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:void 0};else return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:void 0}}function o(a){if(a!==void 0)if(d("MAWLocalizationEphemeralSettingSetAdminMsg.bs").isEphemeralSettingSetAdminMsg(a))return"admin_msg_armadillo_ephemeral_change_duration";else if(a===d("MAWLocalizationType.bs").cutoverThreadAdminMessage)return"admin_msg_thread_level_cutover";else if(a===d("MAWLocalizationType.bs").e2eeThreadAdminMessage)return"admin_msg_e2ee_thread";else if(a===d("MAWLocalizationType.bs").cutoverRollbackAdminMessage)return"admin_msg_cutover_rollback";else return}function p(a,b,c,e,f){return a.table("admin_message_ctas").add({actionUrl:f.actionUrl,adClientToken:f.adClientToken,adHelpUrl:f.adHelpUrl,adminMessageNicknameParticipantId:f.adminMessageNicknameParticipantId,adPreferenceUrl:f.adPreferenceUrl,ctaId:b,messageId:e.msgId,showAdChoiceIcon:f.showAdChoiceIcon,targetId:f.targetId,targetTitle:f.targetTitle,threadKey:c,timestampMs:d("MAWTimeUtils").toTimestamp(e.ts),title:f.title})}function q(a,c,d){return b("Promise").all([m(a,c,d.msgId),l(a)]).then(function(e){var f=e[1];e=e[0];var g=n(d.adminType);if(e!==void 0)return b("Promise").resolve({ctaId:e.ctaId,ctaType:o(d.adminType),title:e.title});else return p(a,f,c,d,g).then(function(a){return{ctaId:f,ctaType:o(d.adminType),title:g.title}})})}function a(a,c,e){var f=e.adminType;if(f!==void 0&&(d("MAWLocalizationEphemeralSettingSetAdminMsg.bs").isEphemeralSettingSetAdminMsg(f)||f===d("MAWLocalizationType.bs").cutoverThreadAdminMessage||f===d("MAWLocalizationType.bs").e2eeThreadAdminMessage||f===d("MAWLocalizationType.bs").cutoverRollbackAdminMessage))return q(a,c,e).then(function(a){return{result:a,threadKey:c}});else return b("Promise").resolve({result:void 0,threadKey:c})}e=p;f=q;h=a;g.insertAdminMsgCta=e;g.createOrReturnExistingAdminMsgCta=f;g.getAdminMsgCtaStep=h}),98);
__d("MAWAdminMsgNormalized",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return{contactIds:b,contents:[]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:a=b[0];var c=b[1];return{contactIds:[a],contents:[c]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:a=b[0];c=b[1];var e=b[2];return{contactIds:[a,c],contents:[e]};case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:default:return{contactIds:[],contents:b}}}g.deconstructContactIdsFromAdminContent=a}),98);
__d("MAWMedia.bs",["MAWDbMedia","MessagingAttachmentType.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a===d("MAWDbMedia").IMAGE)return d("MessagingAttachmentType.bs").image;else if(a===d("MAWDbMedia").VIDEO)return d("MessagingAttachmentType.bs").video;else if(a===d("MAWDbMedia").PTT)return d("MessagingAttachmentType.bs").audio;else if(a===d("MAWDbMedia").GIF)return d("MessagingAttachmentType.bs").animatedImage;else if(a===d("MAWDbMedia").STICKER)return d("MessagingAttachmentType.bs").sticker;else return d("MessagingAttachmentType.bs").none}g.mediaTypeToMessageAttachmentType=a;g.mediaIdToIntExn=c("bs_caml_int64").of_int32}),98);
__d("bs_js_mapperRt",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null)throw{RE_EXN_ID:"Not_found",Error:new Error()};return a}function b(a,b,c){var d=0;while(!0){var e=d;if(e===a)return;var f=b[e];if(f===c)return e;d=e+1|0;continue}}function c(a,b,c){var d=0;while(!0){var e=d;if(e===a)throw{RE_EXN_ID:"Not_found",Error:new Error()};var f=b[e];if(f===c)return e;d=e+1|0;continue}}f.raiseWhenNotFound=a;f.fromInt=b;f.fromIntAssert=c}),null);
__d("MAWXMA.bs",["bs_caml_int64","bs_js_mapperRt"],(function(a,b,c,d,e,f,g){"use strict";var h=[4,9,10,11,12,13,14,15,16,17,18,1e3,1001,1002,1003,1004,1005];function a(a){return h[a]}function b(a){return d("bs_js_mapperRt").fromInt(17,h,a)}f={tFromJs:b,tToJs:a};function e(a){if(a===11)return"xma_open_native"}g.ExtendedContentTargetType=f;g.extendedContentCTAButtonTypeToLSCTAType=e;g.xmaIdToIntExn=c("bs_caml_int64").of_int32}),98);
__d("MAWFrontendMediaUtils",["MAWDbMedia","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==="image/gif")return{mediaType:d("MAWDbMedia").MEDIA_TYPE.GIF,serverMediaType:"gif"};if(a==="image/webp")return{mediaType:d("MAWDbMedia").MEDIA_TYPE.STICKER,serverMediaType:"sticker"};var b=a.split("/")[0];switch(b){case"image":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.IMAGE,serverMediaType:"image"};case"video":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.VIDEO,serverMediaType:"video"};case"audio":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.PTT,serverMediaType:"ptt"};default:throw c("err")("get a wrong media file with type "+a)}}g.getMediaTypeAndServerMediaTypeFromBlob=a}),98);
__d("QPLUserCountEvent",["QPLUserFlow"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("QPLUserFlow").start(a),c("QPLUserFlow").endSuccess(a)}g.fireQplUserCount=a}),98);
__d("MNLSXMATemplateType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").neg_one;f.genericShare=a;f.default_=c}),null);
__d("MNXMAPreviewImageDecorationType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8],k=[0,9];f.default_=a;f.collage=c;f.video=d;f.messengerIcon=e;f.instagramIcon=b;f.shopping=g;f.upcomingEvent=h;f.live=i;f.reel=j;f.igtv=k}),null);
__d("MAWBridgeNewXMAHandler.bs",["I64","MAWDbMsg","MAWThreadId.bs","MAWXMA.bs","MNLSXMALayoutType.bs","MNLSXMATemplateType.bs","MNXMAPreviewImageDecorationType.bs","MessagingAttachmentType.bs","Promise","ReQL.bs","bs_belt_Array","bs_belt_Option","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(a===void 0)return;a=c("bs_belt_Array").get(a,b-1|0);if(a===void 0)return;b=a.buttonType;if(b!==void 0)return d("MAWXMA.bs").extendedContentCTAButtonTypeToLSCTAType(b)}function i(a,b){if(a===void 0)return;a=c("bs_belt_Array").get(a,b-1|0);if(a!==void 0)return a.title}function j(a){if(a===0||a!==3)return d("MNLSXMALayoutType.bs").single;else return d("MNLSXMALayoutType.bs").portrait}function a(a){return d("MNLSXMATemplateType.bs").default_}function k(a){switch(a){case 10:return d("MNXMAPreviewImageDecorationType.bs").collage;case 14:return d("MNXMAPreviewImageDecorationType.bs").reel;case 5:case 6:case 7:case 8:case 9:case 11:case 15:case 16:case 17:case 18:case 19:return d("MNXMAPreviewImageDecorationType.bs").default_;case 4:case 12:case 13:case 20:case 21:case 22:case 23:return d("MNXMAPreviewImageDecorationType.bs").instagramIcon;default:return d("MNXMAPreviewImageDecorationType.bs").default_}}function l(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=String(e.xmaId),l=e.msgId;if(l!==void 0)return d("ReQL.bs").first(d("ReQL.bs").fromTableDescending(a.table("attachment_ctas"))).then(function(d){var h=d!==void 0?c("bs_caml_int64").add(d.ctaId,c("bs_caml_int64").one):c("bs_caml_int64").one;d=e.defaultCTA;if(d===void 0)return b("Promise").resolve([void 0,h]);var i=d.actionUrl,j=d.nativeUrl;return a.table("attachment_ctas").add({actionContentBlob:void 0,actionUrl:i!==void 0?i:d.nativeUrl,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,ctaId:h,enableExtensions:!1,extensionHeightType:void 0,messageId:l,nativeUrl:j!==void 0?j:d.actionUrl,platformToken:void 0,targetId:void 0,threadKey:f,title:c("bs_belt_Option").getWithDefault(d.title,""),type_:"xma_web_url",urlWebviewType:void 0}).then(function(a){return b("Promise").resolve([h,h])})}).then(function(d){var h=d[1],i=d[0],j=[];d=e.ctas;if(d===void 0)return b("Promise").resolve([i,[]]);d=d.map(function(b,d){d=c("bs_caml_int64").add(h,c("bs_caml_int64").of_int32(d+1|0));j.push(d);var e=b.actionUrl,i=b.nativeUrl;return a.table("attachment_ctas").add({actionContentBlob:void 0,actionUrl:e!==void 0?e:b.nativeUrl,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,ctaId:d,enableExtensions:!1,extensionHeightType:void 0,messageId:l,nativeUrl:i!==void 0?i:b.actionUrl,platformToken:void 0,targetId:void 0,threadKey:f,title:c("bs_belt_Option").getWithDefault(b.title,"Tap to view status update"),type_:"xma_web_url",urlWebviewType:void 0})});return b("Promise").all(d).then(function(a){return b("Promise").resolve([i,j])})}).then(function(b){var m=b[1],n=c("bs_caml_int64").of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(l)),o=d("MAWXMA.bs").ExtendedContentTargetType.tFromJs(e.targetType),p,q=0;o===13?p={height:d("I64").of_int32(108),width:d("I64").of_int32(72),xmaContentType:"xma_montage_share"}:q=1;q===1&&(p={height:e.previewHeight!=null?d("I64").of_int32(e.previewHeight):void 0,width:e.previewWidth!=null?d("I64").of_int32(e.previewWidth):void 0,xmaContentType:"xma_web_url"});return a.table("attachments").add({accessibilitySummaryText:void 0,actionUrl:void 0,attachmentCta1Id:m.length>0?m[0]:void 0,attachmentCta2Id:m.length>1?m[1]:void 0,attachmentCta3Id:m.length>2?m[2]:void 0,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,attachmentLoggingType:void 0,attachmentType:d("MessagingAttachmentType.bs").xma,attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,attributionAppId:void 0,attributionAppName:void 0,authorityLevel:c("bs_caml_int64").zero,avatarCount:void 0,avatarViewAccessibilityLabel:void 0,avatarViewSize:void 0,avatarViewTitleList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewUrlList:void 0,captionBodyText:void 0,cta1Title:i(e.ctas,1),cta1Type:h(e.ctas,1),cta2Title:i(e.ctas,2),cta2Type:h(e.ctas,2),cta3Title:i(e.ctas,3),cta3Type:h(e.ctas,3),dashManifest:void 0,decryptionKey:void 0,defaultCtaId:b[0],defaultCtaTitle:c("bs_belt_Option").getWithDefault(c("bs_belt_Option").map(e.defaultCTA,function(a){return a.title})),defaultCtaType:p.xmaContentType,descriptionText:void 0,ephemeralMediaState:void 0,faviconUrl:void 0,faviconUrlExpirationTimestampMs:void 0,faviconUrlFallback:void 0,filename:void 0,filesize:e.filesize!=null?d("I64").of_int32(e.filesize):void 0,gatingTitle:void 0,gatingType:e.overlayIconGlyph!=null?String(e.overlayIconGlyph):void 0,hasMedia:!1,hasXma:!0,headerImageUrl:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlFallback:void 0,headerImageUrlMimeType:void 0,headerTitle:e.headerTitle,imageUrl:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlFallback:void 0,imageUrlMimeType:void 0,isBorderless:void 0,isPreviewImage:void 0,isSharable:!0,listItemAccessibilityText1:void 0,listItemAccessibilityText2:void 0,listItemAccessibilityText3:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList1:void 0,listItemContactUrlFallbackList2:void 0,listItemContactUrlFallbackList3:void 0,listItemContactUrlList1:void 0,listItemContactUrlList2:void 0,listItemContactUrlList3:void 0,listItemId1:void 0,listItemId2:void 0,listItemId3:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrlFallback3:void 0,listItemProgressBarFilledPercentage1:void 0,listItemProgressBarFilledPercentage2:void 0,listItemProgressBarFilledPercentage3:void 0,listItemsDescriptionSubtitleText:void 0,listItemsDescriptionText:void 0,listItemsId:void 0,listItemsSecondaryDescriptionText:void 0,listItemTitleText1:void 0,listItemTitleText2:void 0,listItemTitleText3:void 0,localPlayableUrl:void 0,maxSubtitleNumOfLines:e.maxSubtitleNumOfLines!=null?d("I64").of_int32(e.maxSubtitleNumOfLines):void 0,maxTitleNumOfLines:e.maxTitleNumOfLines!=null?d("I64").of_int32(e.maxTitleNumOfLines):void 0,messageId:l,miniPreview:void 0,offlineAttachmentId:g,originalFileHash:void 0,originalPageSenderId:void 0,playableDurationMs:void 0,playableUrl:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlFallback:void 0,playableUrlMimeType:void 0,preheaderText:void 0,previewHeight:p.height,previewHeightLarge:e.previewHeightLarge!=null?d("I64").of_int32(e.previewHeightLarge):void 0,previewImageDecorationType:k(e.targetType),previewUrl:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlFallback:void 0,previewUrlLarge:void 0,previewUrlMimeType:void 0,previewWidth:p.width,previewWidthLarge:e.previewWidthLarge!=null?d("I64").of_int32(e.previewWidthLarge):void 0,samplingFrequencyHz:void 0,shouldAutoplayVideo:void 0,shouldHighlightHeaderTitleInTitle:void 0,shouldRespectServerPreviewSize:void 0,sourceText:void 0,subtitleIconUrl:void 0,subtitleText:e.subtitleText,targetId:void 0,threadKey:f,timestampMs:n,titleText:e.titleText,viewerSeenTimestampMs:void 0,waveformData:void 0,xmaLayoutType:e.xmaLayoutType!=null?j(e.xmaLayoutType):void 0,xmasTemplateType:e.xmaLayoutType!=null?j(e.xmaLayoutType):void 0})});else return b("Promise").resolve()})}function e(a,b){return l(a,b).then(function(a){})}g.getCTAType=h;g.getCTATitle=i;g.getLSXMALayoutType=j;g.getLSXMATemplateType=a;g.getLSPreviewImageDecorationType=k;g.call=e}),98);
__d("MAWBridgeTypes.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{_0:a,TAG:1}}function b(a){return{_0:a,TAG:2}}function c(a){return{_0:a,TAG:0}}function d(a){return{_0:a,TAG:1}}function e(a){return{_0:a,TAG:2}}function g(a){return{_0:void 0,TAG:0}}f.makeInitialThreadRange=a;f.makeThreadRangeForLoadBefore=b;f.makeThreadRangeNoThreads=c;f.makeInitialRange=d;f.makeExtendBefore=e;f.makeNoMsg=g}),66);
__d("MAWBridgeTypes.re",["MAWBridgeTypes.bs"],(function(a,b,c,d,e,f){c=(a=b("MAWBridgeTypes.bs")).makeInitialThreadRange;f.makeInitialThreadRange=c;d=a.makeThreadRangeForLoadBefore;f.makeThreadRangeForLoadBefore=d;e=a.makeThreadRangeNoThreads;f.makeThreadRangeNoThreads=e;b=a.makeInitialRange;f.makeInitialRange=b;c=a.makeExtendBefore;f.makeExtendBefore=c;d=a.makeNoMsg;f.makeNoMsg=d}),null);
__d("MAWBridgeTypesWrapper",["MAWAckLevel"],(function(a,b,c,d,e,f,g){"use strict";function h(a){switch(a.TAG){case 0:return"User";case 1:return"Group"}}function i(a){switch(a){case"User":return{_0:void 0,TAG:0};case"Group":return{_0:void 0,TAG:1}}}function a(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToJS(a.ack)})}function b(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToRE(a.ack)})}function c(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToJS(a.ack),threadType:h(a.threadType)})}function e(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToRE(a.ack),threadType:i(a.threadType)})}g.bridgeMsgToJS=a;g.bridgeMsgToRE=b;g.bridgeStartTraceDataToJS=c;g.bridgeStartTraceDataToRE=e}),98);
__d("MAWBridgeAbPropsUpdatedHandler.bs",["MAWAbPropsClient.bs"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("MAWAbPropsClient.bs").rewrite(a);return window.Promise.resolve()}g.call=a}),98);
__d("MAWBridgeDeleteGroupInviteHandler",["MAWThreadId","Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){return d("MAWThreadId").toThreadKeyMaybe(a,c.threadId).then(function(c){return c==null?b("Promise").resolve():d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("group_invites")).getKeyRange(c)).then(function(c){return c.reduce(function(b,c){return b.then(function(){return a.table("group_invites")["delete"]({hd:c.threadKey,tl:{hd:c.inviterId,tl:{hd:c.inviteeId,tl:0}}})})},b("Promise").resolve(void 0))})})}g["default"]=a}),98);
__d("MAWBridgeDeleteMessageRangesV2Handler.bs",["MAWThreadId.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(d){if(d!==void 0)return a.table("messages_ranges_v2__generated")["delete"]({hd:d,tl:{hd:c("bs_caml_int64").of_float(e.minTimestampMs),tl:{hd:e.minMsgId,tl:0}}});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeDeleteMessagesHandler",["MAWThreadId","MAWTimeUtils","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c.threadId));case 2:e=k.sent;if(!(e!==void 0)){k.next=20;break}f=c.messages,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 5:if(!g){k.next=11;break}if(!(h>=f.length)){k.next=8;break}return k.abrupt("break",20);case 8:i=f[h++];k.next=15;break;case 11:h=f.next();if(!h.done){k.next=14;break}return k.abrupt("break",20);case 14:i=h.value;case 15:j=i;k.next=18;return b("regeneratorRuntime").awrap(a.table("messages")["delete"](d("ReQL").key(e,d("MAWTimeUtils").toTimestamp(j.ts),j.msgId)));case 18:k.next=5;break;case 20:case"end":return k.stop()}},null,this)}g["default"]=a}),98);
__d("MAWBridgeDeleteReactionHandler.bs",["MAWThreadId.bs","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(d){if(d!==void 0)return a.table("reactions")["delete"]({hd:d,tl:{hd:e.messageId,tl:{hd:c("bs_caml_format").caml_int64_of_string(e.actorId),tl:0}}});else return b("Promise").resolve()})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeEphemeralSettingsUpdatedForUIHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("Promise").resolve()}f.call=a}),66);
__d("MAWBridgeGroupInfoUpdatedHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=e.threadName,h=g==null?void 0:c("bs_caml_option").some(g);return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:f,tl:0})).then(function(c){if(c===void 0)return b("Promise").resolve();c=babelHelpers["extends"]({},c,{threadName:h});return a.table("threads").put(c)})})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeGroupInviteUpdateHandler.bs",["MAWThreadId.bs","MAWTimeUtils","MAWUpdateLSThreadCapabilities.bs","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.inviterId);return a.table("group_invites").put({caption:e.caption!=null?e.caption:void 0,inviteCode:e.inviteCode,inviteeId:c("bs_caml_format").caml_int64_of_string(e.inviteeId),inviteExpirationTimestampMs:d("MAWTimeUtils").toTimestamp(e.inviteExpireTs),inviterId:g,threadKey:f}).then(function(b){return d("MAWUpdateLSThreadCapabilities.bs").setGroupInviteTxn(a,f,g)})})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeInitOfflineQueueSyncCompleteHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";var h=[2328,1316134911];function i(a){return a.table("sync_groups").put({canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("MAWInitSyncComplete.bs").id,initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:h,priority:c("bs_caml_int64").zero,regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSSyncChannel.bs").mqtt,syncParams:d("LSJson").stringify(new(c("LSDict"))([["locale",c("CurrentLocale").get()]])),syncStatus:d("LSSyncStatus.bs").complete})}function a(a){d("LSLogHistory").log("Init Offline Queue Sync Complete","debug");return window.Promise.resolve([i(a)]).then(function(a){return b("Promise").resolve()})}g.neverSyncTimestamp=h;g.finishOfflineArmadilloSyncCursor=i;g.call=a}),98);
__d("MAWBridgeInitOfflineQueueSyncProgressHandler.bs",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("Promise").resolve()}f.call=a}),66);
__d("MAWBridgeInitOfflineQueueSyncStartHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";var h=[2328,1316134911];function i(a){return a.table("sync_groups").put({canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("MAWInitSyncComplete.bs").id,initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:h,priority:c("bs_caml_int64").zero,regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSSyncChannel.bs").mqtt,syncParams:d("LSJson").stringify(new(c("LSDict"))([["locale",c("CurrentLocale").get()]])),syncStatus:d("LSSyncStatus.bs").paging})}function a(a,c){d("LSLogHistory").log("Init Offline Queue Sync Start","debug");return window.Promise.resolve([i(a)]).then(function(a){return b("Promise").resolve()})}g.neverSyncTimestamp=h;g.initOfflineArmadilloSyncCursor=i;g.call=a}),98);
__d("MWChatFetchThreadMessageCounts",["I64","Promise","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c={};g.next=3;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("threads")).filter(function(a){return d("I64").to_int32(a.threadType)===16||d("I64").to_int32(a.threadType)===15}).map(function(a){return a.threadKey})));case 3:e=g.sent;g.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(e.map(function(b){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("messages")).getKeyRange(b).filter(function(a){return!a.isAdminMessage}))})));case 6:f=g.sent;e.forEach(function(a,b){c[d("I64").to_string(a)]=f[b].length});return g.abrupt("return",c);case 9:case"end":return g.stop()}},null,this)}function c(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("messages")).getKeyRange(c).filter(function(a){return!a.isAdminMessage})));case 2:e=f.sent;return f.abrupt("return",e.length);case 4:case"end":return f.stop()}},null,this)}g.fetchArmadilloThreadMessageCounts=a;g.fetchArmadilloThreadMessageCount=c}),98);
__d("MWChatDataLossCheckerUtil",["Crypto.bs","FBLogger","I64","MAWBackendBridge.bs","MAWThreadId.bs","MWChatFetchThreadMessageCounts","Promise","QuickPerformanceLogger","WebStorage","gkx","promiseDone","qex","qpl","regeneratorRuntime","useDataLossStatisticsStorageListener"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=Array.from(new Uint8Array(a));return a.map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function i(a){var e,f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.prev=0;if(!c("qex")._("460")){i.next=3;break}return i.abrupt("return",a);case 3:e=new TextEncoder();f=e.encode(a).buffer;i.next=7;return b("regeneratorRuntime").awrap(d("Crypto.bs").digest("SHA-256",f));case 7:g=i.sent;return i.abrupt("return",h(g));case 11:i.prev=11;i.t0=i["catch"](0);return i.abrupt("return",i.t0);case 14:case"end":return i.stop()}},null,this,[[0,11]])}function j(a){var d,e,f,g,h,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:d=a.currentIDBCnt,e=a.currentMsgCnt,f=a.logThreadId,g=a.prevMsgCnt,h=a.qplEvent,j=a.threadId;if(!(f!==void 0&&f)){l.next=8;break}l.next=4;return b("regeneratorRuntime").awrap(i(j));case 4:k=l.sent;d!==void 0?(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_idb_count:d,current_msg_count:e,prev_msg_count:g},string:{encrypted_threadId:k}}),c("QuickPerformanceLogger").markerEnd(h,2)):(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_msg_count:e,prev_msg_count:g},string:{encrypted_threadId:k}}),c("QuickPerformanceLogger").markerEnd(h,2));l.next=9;break;case 8:d!==void 0?(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_idb_count:d,current_msg_count:e,prev_msg_count:g}}),c("QuickPerformanceLogger").markerEnd(h,2)):(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_msg_count:e,prev_msg_count:g}}),c("QuickPerformanceLogger").markerEnd(h,2));case 9:case"end":return l.stop()}},null,this)}function k(a){var e,f,g,h,i,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:e=a.currentMsgCnt,f=a.db,g=a.logThreadId,h=a.prevMsgCnt,i=a.qplEvent,k=a.threadId;if(c("gkx")("7965")){n.next=3;break}return n.abrupt("return",j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k}));case 3:l=-100;n.prev=4;n.next=7;return b("regeneratorRuntime").awrap(d("MAWThreadId.bs").ofThreadKey(f,d("I64").of_string(k)));case 7:m=n.sent;if(!(m.TAG!==0)){n.next=11;break}c("FBLogger")("labyrinth").warn("Fetched Invalid IndexedDB thread id");return n.abrupt("return",j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k}));case 11:l=m._0;n.next=18;break;case 14:n.prev=14;n.t0=n["catch"](4);c("FBLogger")("labyrinth").catching(n.t0).warn("Failed to fetch indexedDB thread Id");return n.abrupt("return",j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k}));case 18:c("promiseDone")(d("MAWBackendBridge.bs").fetchArmadilloThreadMessageCount({threadId:l}).sendAndReceive().then(function(a){return j({currentIDBCnt:a,currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k})})["catch"](function(a){c("FBLogger")("labyrinth").catching(a).warn("Failed to fetch IndexDB message count");return j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k})}));case 19:case"end":return n.stop()}},null,this,[[4,14]])}function a(a,e){var f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.prev=0;k.next=3;return b("regeneratorRuntime").awrap(d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCount(a,e));case 3:g=k.sent;h=c("WebStorage").getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(!(h==null)){k.next=7;break}return k.abrupt("return",{isThreadMissingMessages:!1});case 7:i=JSON.parse(h);j=(f=i[d("I64").to_string(e)])!=null?f:null;if(!(j==null)){k.next=11;break}return k.abrupt("return",{isThreadMissingMessages:!1});case 11:if(!(j>0&&g===0)){k.next=13;break}return k.abrupt("return",{currCount:g,isThreadMissingMessages:!0,prevCount:j});case 13:return k.abrupt("return",{isThreadMissingMessages:!1});case 16:k.prev=16;k.t0=k["catch"](0);c("FBLogger")("labyrinth").catching(k.t0).warn("Failed to check for data loss");return k.abrupt("return",{isThreadMissingMessages:!1});case 20:case"end":return k.stop()}},null,this,[[0,16]])}function e(a){c("promiseDone")(d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a).then(function(a){var e=c("WebStorage").getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(e==null)return b("Promise").resolve(null);e=JSON.parse(e);return b("Promise").resolve({current:a,previous:e})}).then(function(c){if(c==null)return b("Promise").resolve();var d=c.current;c=c.previous;return l(c,d,a)})["catch"](function(a){return c("FBLogger")("labyrinth").catching(a).warn("Failed to check for data loss")}))}function l(a,d,e){var f,g,h,i,j,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:f=[];for(g in a)Object.prototype.hasOwnProperty.call(d,g)&&f.push(g);h=[];for(i=0;i<f.length;i++)j=f[i],l={currentMsgCnt:d[j],db:e,prevMsgCnt:a[j],threadId:j},a[j]>0&&d[j]===0?(h.push(k(babelHelpers["extends"]({},l,{qplEvent:c("qpl")._(717553665,"1183")}))),h.push(k(babelHelpers["extends"]({},l,{logThreadId:!0,qplEvent:c("qpl")._(717562243,"1358")})))):(h.push(k(babelHelpers["extends"]({},l,{qplEvent:c("qpl")._(717553666,"1184")}))),h.push(k(babelHelpers["extends"]({},l,{logThreadId:!0,qplEvent:c("qpl")._(717556541,"1361")}))));m.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(h));case 6:case"end":return m.stop()}},null,this)}function f(a){var b=function(b){c("promiseDone")(i(b).then(function(d){c("QuickPerformanceLogger").markerStartFromNavStart(c("qpl")._(717567419,"1383")),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(717567419,"1383"),{string:{encryptedThreadId:d,msg_count:a[b].toString()}}),c("QuickPerformanceLogger").markerEnd(c("qpl")._(717567419,"1383"),2)}))};for(var d in a)b(d)}g.qplLog=k;g.checkIsThreadMissingMessages=a;g.fetchCountsAndLogDataLoss=e;g.logThreadCompleteDataLoss=l;g.logLocalStatistics=f}),98);
__d("useDataLossStatisticsStorageListener",["MWChatDataLossCheckerUtil","MWChatFetchThreadMessageCounts","Visibility","WebStorage","promiseDone","qex","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useEffect,i="armadillo_msgr_data_loss_stats";function a(){var a=c("useReStore")();h(function(){var b;window.setTimeout(function(){b=c("Visibility").addListener(c("Visibility").HIDDEN,function(){c("promiseDone")(d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a).then(function(a){c("WebStorage").setItemGuarded(c("WebStorage").getLocalStorage(),i,JSON.stringify(a)),c("qex")._("1259")&&d("MWChatDataLossCheckerUtil").logLocalStatistics(a)}))})},3e4);return function(){var a;(a=b)==null?void 0:a.remove()}},[])}g.DATA_LOSS_STATISTICS_STORAGE_KEY=i;g.useDataLossStatisticsStorageListener=a}),98);
__d("MAWBridgeInitSyncCompleteHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","MAWTTRC","MWChatDataLossCheckerUtil","Promise","QPLUserFlow","bs_caml_int64","qex","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.table("sync_groups").add({canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("MAWInitSyncComplete.bs").id,initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:[2328,1316134911],priority:c("bs_caml_int64").zero,regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSSyncChannel.bs").mqtt,syncParams:d("LSJson").stringify(new(c("LSDict"))([["locale",c("CurrentLocale").get()]])),syncStatus:d("LSSyncStatus.bs").complete})}function i(a){return a.table("network_requests").add({epochId:c("bs_caml_int64").neg_one,failureCount:c("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c("bs_caml_int64").zero,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:d("MAWInitSyncComplete.bs").id,taskQueueName:""})}function a(a){d("LSLogHistory").log("Init Sync Complete","debug");c("qex")._("222")&&d("MWChatDataLossCheckerUtil").fetchCountsAndLogDataLoss(a);d("MAWTTRC").markEvent("init_sync_received");c("QPLUserFlow").endSuccess(c("qpl")._(25300040,"1388"));return window.Promise.all([h(a),i(a)]).then(function(a){return b("Promise").resolve()})}g.completeLocalArmadilloSyncCursor=h;g.completeLocalArmadilloNetworkRequest=i;g.call=a}),98);
__d("MAWBridgeMediaExpiredHandler.bs",["MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e=String(c.mediaId);return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.threadId).then(function(d){if(d!==void 0)return a.table("attachments")["delete"]({hd:d,tl:{hd:c.msgId,tl:{hd:e,tl:0}}});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWEphemeralMessageExpirationStorage.bs",["MAWBridgeDeleteMessagesHandler","bs_belt_Array","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a,b,d){c("bs_belt_Array").forEach(b,function(b){var d=b.ts,e=b.chatId,f=b.msgId;f={msgId:f,threadId:e,ts:d};e=b.chatId;d=[f];b={messages:d,threadId:e};c("promiseDone")(c("MAWBridgeDeleteMessagesHandler")(a,b))});return h["delete"](d)}function j(a,b,d,e){return c("setTimeout")(function(c){i(a,b,d)},e)}function a(a,b,d,e){var f=h.get(d);b=f==null?[b]:(c("clearTimeout")(f.timeoutId),f.msgs.map(function(a){return a.msgId}).indexOf(b.msgId)===-1?(f.msgs.push(b),void 0):void 0,f.msgs);f=j(a,b,d,e);h.set(d,{expirationTs:d,msgs:b,timeoutId:f})}function b(a){var b=a.msgId;a=h.get(a.countdownTs);if(a==null)return;b=a.msgs.map(function(a){return a.msgId}).indexOf(b);if(b>-1){a.msgs.splice(b,1);return}}d=a;e=b;g.setMessageForExpiration=d;g.clearMessageFromExpiration=e}),98);
__d("MAWBridgeMsgClearCountdownHandler.bs",["MAWEphemeralMessageExpirationStorage.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("MAWEphemeralMessageExpirationStorage.bs").clearMessageFromExpiration(a);return b("Promise").resolve()}g.call=a}),98);
__d("LSMessageUnsendabilityStatus.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8];f.canUnsend=a;f.denyLogMessage=c;f.denyTombstoneMessage=d;f.denyForNonSender=e;f.denyP2pPayment=b;f.denyStoryReaction=g;f.denyBlobAttachment=h;f.denyMessageNotFound=i;f.denyMessageInstagramDirectWriteRestriction=j}),null);
__d("LSMessageUnsendabilityStatus.re",["LSMessageUnsendabilityStatus.bs"],(function(a,b,c,d,e,f){c=(a=b("LSMessageUnsendabilityStatus.bs")).canUnsend;f.canUnsend=c;d=a.denyLogMessage;f.denyLogMessage=d;e=a.denyTombstoneMessage;f.denyTombstoneMessage=e;b=a.denyForNonSender;f.denyForNonSender=b;c=a.denyP2pPayment;f.denyP2pPayment=c;d=a.denyStoryReaction;f.denyStoryReaction=d;e=a.denyBlobAttachment;f.denyBlobAttachment=e;b=a.denyMessageNotFound;f.denyMessageNotFound=b;c=a.denyMessageInstagramDirectWriteRestriction;f.denyMessageInstagramDirectWriteRestriction=c}),null);
__d("LSContactGender",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FEMALE:1,MALE:2,NEUTER:3});f["default"]=a}),66);
__d("LSContactIdType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FBID:1,SMS_LOCAL_ID:2});f["default"]=a}),66);
__d("LSContactViewerRelationship",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,NOT_CONTACT:1,CONTACT_OF_VIEWER:2,FACEBOOK_FRIEND:3,SOFT_CONTACT:4});f["default"]=a}),66);
__d("LSContactWorkForeignEntityType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FOREIGN:1,NOT_FOREIGN:2,NOT_FOREIGN_LIMITED:3});f["default"]=a}),66);
__d("MAWSubscribeToContactNames",["fbt","$InternalEnum","CurrentUser","Env","I64","LS.re","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSVerifyContactRowExists","Promise","ReQL","Run","SubscriptionsHandler","gkx","promiseDone","regeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("$InternalEnum").Mirrored(["FIRST_NAME","FULL_NAME"]),j=new Map(),k=Boolean(c("Env").isMessengerDotComOnComet)?"Messenger":c("gkx")("1902661")?"Instagram":"Facebook";function l(){return h._("__JHASH__9kaBCOd2SjE__JHASH__",[h._param("Platform Name",k)]).toString()}function a(a,b){return(a=a.get(b))!=null?a:l()}function m(a,b){return b===i.FULL_NAME?a==null?void 0:a.name:a==null?void 0:a.firstName}function n(a,b,e,f){var g=d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(d("I64").of_string(b)).subscribe(function(a,b){if(b.operation==="delete")return;a=m(b.value,e);if(a==null||a==="")return;c("promiseDone")(f(a),g)});return g}function o(a,c){return b("Promise").all(c.map(function(c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(d("I64").of_string(c))));case 2:e=f.sent;return f.abrupt("return",e==null||e.name===""?c:null);case 4:case"end":return f.stop()}},null,this)})).then(function(a){return a.filter(Boolean)})}function p(a,b,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(d("I64").of_string(b))).then(function(a){return m(a,c)})}function q(a,b){return c("LSVerifyContactRowExists")(d("I64").of_string(b),d("I64").of_int32(c("LSContactIdType").FBID),void 0,void 0,d("I64").of_int32(c("LSContactType").USER),void 0,void 0,void 0,void 0,!1,!1,d("I64").of_int32(c("LSContactBlockedByViewerStatus").UNBLOCKED),void 0,b===c("CurrentUser").getID(),d("I64").of_int32(c("LSAuthorityLevel").OPTIMISTIC),void 0,void 0,d("I64").of_int32(c("LSContactWorkForeignEntityType").UNKNOWN),d("I64").of_int32(c("LSContactGender").UNKNOWN),d("I64").of_int32(c("LSContactViewerRelationship").UNKNOWN),void 0,c("LS.re").make(a))}function r(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(o(a,c));case 2:d=e.sent;e.next=5;return b("regeneratorRuntime").awrap(b("Promise").all(d.map(function(b){return q(a,b)})));case 5:case"end":return e.stop()}},null,this)}function s(a){var b=function(){var b=j.get(a);b==null?(b=new(c("SubscriptionsHandler"))(),j.set(a,b)):(b.release(),b.engage());return b}(),e=d("Run").onBeforeUnload(function(){j.forEach(function(a){return a.release()}),j.clear()},!1);return{add:function(a){b.addSubscriptions({unsubscribe:a})},release:function(){e.remove(),b.release(),j["delete"](a)}}}function t(a){var c,d,e,f,g,h,j,k,m,o,q;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:c=a.contactIDs,d=a.db,e=a.nameMode,f=e===void 0?i.FIRST_NAME:e,g=a.onResolve,h=a.subscriptionKey,j=a.txn;t.next=3;return b("regeneratorRuntime").awrap(r(j,c));case 3:k=new Map();m=s(h);o=function(a,b){b=(b=k.get(b))!=null?b:l();return[a,b]};t.next=8;return b("regeneratorRuntime").awrap(b("Promise").all(c.map(function(a,e){var h,i;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:q.next=2;return b("regeneratorRuntime").awrap(p(j,a,f));case 2:h=q.sent;if(!(h!=null&&h!=="")){q.next=6;break}k.set(e,h);return q.abrupt("return",[a,h]);case 6:g!=null&&(i=n(d,a,f,function(a){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:i();k.set(e,a);if(!(k.size===c.length)){d.next=6;break}m.release();d.next=6;return b("regeneratorRuntime").awrap(g(new Map(c.map(o))));case 6:case"end":return d.stop()}},null,this)}),m.add(i));return q.abrupt("return",[a,l()]);case 8:case"end":return q.stop()}},null,this)})));case 8:q=t.sent;return t.abrupt("return",new Map(q));case 10:case"end":return t.stop()}},null,this)}function e(a){var b=a.contactIDs,c=a.onResolve;a=babelHelpers.objectWithoutPropertiesLoose(a,["contactIDs","onResolve"]);var d=function(a){return b.map(function(b){return(b=a.get(b))!=null?b:l()})},e=function(){return c==null?void 0:function(a){return c(d(a))}}();return t(babelHelpers["extends"]({},a,{contactIDs:b,onResolve:e})).then(d)}g.ContactNameMode=i;g.getUnknownUser=l;g.getContactNameFromLookup=a;g.getMissingContactNames=o;g.getContactNameFromContactID=p;g.fillMissingContacts=r;g.genContacts=t;g.getContactNamesFromContactIDs=e}),98);
__d("MAWUpdateMsg",["MAWThreadId","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f,g){return a.runInTransaction(function(h){var i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c));case 2:i=l.sent;if(!(i==null)){l.next=5;break}return l.abrupt("return");case 5:j=h.table("messages");l.next=8;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(j).getKeyRange(i,e,f)));case 8:k=l.sent;if(!(k!=null)){l.next=12;break}l.next=12;return b("regeneratorRuntime").awrap(j.put(babelHelpers["extends"]({},k,{text:g})));case 12:case"end":return l.stop()}},null,this)},"readwrite")}g.mutateThreadText=a}),98);
__d("MAWBridgeBuildAdminMsg",["I64","MAWAdminMsg","MAWAdminMsgNormalized","MAWLocalizationType","MAWSubscribeToContactNames","MAWUpdateMsg","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f,g,h,i,j){var k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:j===void 0&&(j=0);k=d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(i,h),l=k.contactIds,m=k.contents;if(!(j===1)){p.next=8;break}n=i===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP?d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME;p.next=6;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:[].concat(l),db:a,nameMode:n,onResolve:function(b){b=d("MAWAdminMsg").buildLocalizedString(m,b,i);return d("MAWUpdateMsg").mutateThreadText(a,e,f,g,b)},subscriptionKey:d("I64").to_string(f),txn:c}));case 6:o=p.sent;return p.abrupt("return",d("MAWAdminMsg").buildLocalizedString(m,o,i));case 8:return p.abrupt("return",d("MAWAdminMsg").buildLocalizedString(m,l,i));case 9:case"end":return p.stop()}},null,this)}g.buildAdminMsgText=a}),98);
__d("mapMapKeys",[],(function(a,b,c,d,e,f){a=function(a,b){var c=new Map();a.forEach(function(a,d){c.set(b(a,d),a)});return c};b=a;f["default"]=b}),66);
__d("mapPull",[],(function(a,b,c,d,e,f){function a(a,b,c){var d=new Map();for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;d.set(c(g),b(g))}return d}f["default"]=a}),66);
__d("MAWBridgeBuildMsgMentions",["MAWSubscribeToContactNames","WAJids","emptyFunction","mapMapKeys","mapPull","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return Array.from(b).reduce(function(a,b){var c=b[0];b=b[1];return a.replaceAll(b,c)},a)}function i(a,b,e){e=c("mapMapKeys")(e,function(a,c){return d("MAWSubscribeToContactNames").getContactNameFromLookup(b,c)});return h(a,e)}function j(a,b,c,e){a=i(a,c,e);e=b.map(function(a){return d("MAWSubscribeToContactNames").getContactNameFromLookup(c,a)});return[a,e]}function a(a,e,f,g,h,j){var k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:k=c("mapPull")(h,c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);m.next=3;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").genContacts({contactIDs:Array.from(k.keys()),db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME,onResolve:function(a){a=i(g,a,k);return j(a)},subscriptionKey:f,txn:e}));case 3:l=m.sent;return m.abrupt("return",i(g,l,k));case 5:case"end":return m.stop()}},null,this)}function e(a,e,f,g,h,i,k){var l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:m=c("mapPull")((l=h)!=null?l:[],c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);if(!(m.size===0||g==null||g==="")){p.next=6;break}p.next=4;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:i,db:a,onResolve:function(a){return k([g,a])},subscriptionKey:f,txn:e}));case 4:n=p.sent;return p.abrupt("return",[g,n]);case 6:p.next=8;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").genContacts({contactIDs:[].concat(Array.from(m.keys()),i),db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME,onResolve:function(a){a=j(g,i,a,m);return k(a)},subscriptionKey:f,txn:e}));case 8:o=p.sent;return p.abrupt("return",j(g,i,o,m));case 10:case"end":return p.stop()}},null,this)}g.buildMsgTextWithMentions=a;g.buildThreadSnippetWithMentions=e}),98);
__d("LSReplyMessageStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,VALID:1,DELETED:2,TEMPORARY_UNAVAILABLE:3,EXPIRED:4});f["default"]=a}),66);
__d("MAWMsgReply",["fbt","LSReplyMessageStatus","MAWSubscribeToContactNames","MAWThreadId","MAWTimeUtils","ODS","Promise","ReQL","WAMsgType","err","regeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){var b=a.isAuthorMe,c=a.isDeletedMsg,d=a.isStoryReply;d=d===void 0?!1:d;var e=a.isStoryShare;e=e===void 0?!1:e;var f=a.recipientName,g=a.replySenderIsMe;g=g===void 0?!1:g;var i=a.replySenderIsRecepient;a=a.senderName;switch(!0){case b&&c:return h._("__JHASH__FzueDOoURT8__JHASH__");case b&&e:return h._("__JHASH__d4DLCdwDC03__JHASH__");case b&&g:return h._("__JHASH__GiGYAtipVIl__JHASH__");case b&&d:return f!=null?h._("__JHASH__ZkkDtvZx-as__JHASH__",[h._param("name",f)]):h._("__JHASH__GEUovmERkjj__JHASH__");case b:return f!=null?h._("__JHASH__eQLjVyXwwuH__JHASH__",[h._param("other_name",f)]):h._("__JHASH__NYU_gsfRGpq__JHASH__");case c:return h._("__JHASH__30kvLEU_B_p__JHASH__",[h._param("name",a)]);case i:return h._("__JHASH__RWi7lW394uo__JHASH__",[h._param("other",a)]);case e:return h._("__JHASH__JQwHPEO2e9j__JHASH__",[h._param("user",a)]);case g&&d:return h._("__JHASH__zc6GoZLyKDZ__JHASH__",[h._param("name",a)]);case g:return h._("__JHASH__uU6-xunUPnp__JHASH__",[h._param("other_name",a)]);default:return f!=null?h._("__JHASH__iOHMd6RP1E7__JHASH__",[h._param("other",a),h._param("other_name",f)]):h._("__JHASH__JL2f9yie2zt__JHASH__",[h._param("other",a)])}}function a(a,e,f){var g,h,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;return b("regeneratorRuntime").async(function(C){while(1)switch(C.prev=C.next){case 0:h=f.chatId,l=f.isAuthorMe,m=f.isStoryReply,n=f.isStoryShare,o=n===void 0?!1:n,p=f.msgId,q=f.originalTs,r=f.replySenderIsMe,s=f.replySourceId,t=f.replyToUserId,u=f.sender,v=f.ts,w=f.type_;if(!(s==null&&!o)){C.next=3;break}return C.abrupt("return",b("Promise").resolve());case 3:if(!(t==null||u==null)){C.next=5;break}throw c("err")("Error getting reply snippet without replyToUserId or sender");case 5:x=d("MAWSubscribeToContactNames").getContactNameFromContactID(e,t,d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME)==null;y=d("MAWSubscribeToContactNames").getContactNameFromContactID(e,u,d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME)==null;d("ODS").bumpEntityKey(3185,"armadillo_reply","creating_reply_snippet");x&&y?d("ODS").bumpEntityKey(3185,"armadillo_reply","missing_both"):y?d("ODS").bumpEntityKey(3185,"armadillo_reply","missing_sender"):x&&d("ODS").bumpEntityKey(3185,"armadillo_reply","missing_reply_to");C.next=11;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:[t,u],db:a,onResolve:function(b){var e,g=b[0];b=b[1];return k(a,h,d("MAWTimeUtils").toTimestamp(w===d("WAMsgType").MSG_TYPE.REVOKED?(e=q)!=null?e:v:v),p,(e=i({isAuthorMe:l,isDeletedMsg:j(f)===c("LSReplyMessageStatus").DELETED,isStoryReply:m,isStoryShare:o,recipientName:g,replySenderIsMe:r,replySenderIsRecepient:u===t,senderName:b}))==null?void 0:e.toString())},subscriptionKey:p,txn:e}));case 11:z=C.sent;A=z[0];B=z[1];return C.abrupt("return",b("Promise").resolve((g=i({isAuthorMe:l,isDeletedMsg:j(f)===c("LSReplyMessageStatus").DELETED,isStoryReply:m,isStoryShare:o,recipientName:x?void 0:A,replySenderIsMe:r,replySenderIsRecepient:u===t,senderName:B}))==null?void 0:g.toString()));case 15:case"end":return C.stop()}},null,this)}function j(a){a=a.replyStatusType;switch(a){case d("WAMsgType").MSG_TYPE.DELETE_FOR_ME:case d("WAMsgType").MSG_TYPE.REVOKED:return c("LSReplyMessageStatus").DELETED;case d("WAMsgType").MSG_TYPE.TEXT:case d("WAMsgType").MSG_TYPE.IMAGE:case d("WAMsgType").MSG_TYPE.VIDEO:case d("WAMsgType").MSG_TYPE.PTT:case d("WAMsgType").MSG_TYPE.ADMIN:case d("WAMsgType").MSG_TYPE.GIF:case d("WAMsgType").MSG_TYPE.STICKER:case d("WAMsgType").MSG_TYPE.XMA:return c("LSReplyMessageStatus").VALID;case d("WAMsgType").MSG_TYPE.FUTUREPROOF:case d("WAMsgType").MSG_TYPE.CIPHERTEXT:case d("WAMsgType").MSG_TYPE.UNAVAILABLE:return c("LSReplyMessageStatus").TEMPORARY_UNAVAILABLE;case d("WAMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:return c("LSReplyMessageStatus").UNKNOWN;case d("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return c("LSReplyMessageStatus").EXPIRED;default:return void 0}}function k(a,c,e,f,g){var h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c));case 2:h=i.sent;if(!(h==null)){i.next=5;break}return i.abrupt("return",b("Promise").resolve());case 5:return i.abrupt("return",a.runInTransaction(function(a){var c,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:c=a.table("messages");j.next=3;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(c).getKeyRange(h,e,f)));case 3:i=j.sent;if(!i){j.next=7;break}j.next=7;return b("regeneratorRuntime").awrap(c.put(babelHelpers["extends"]({},i,{replySnippet:g})));case 7:case"end":return j.stop()}},null,this)},"readwrite"));case 6:case"end":return i.stop()}},null,this)}g.buildLocalizedReplySnippet=i;g.getReplySnippet=a;g.getReplyStatus=j}),98);
__d("MAWMsgReply.bs",["LSMessageReplySourceTypeV2.bs","LSReplyMessageAttachmentType.bs","MAWGating","MAWMedia.bs","MAWXMA.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_option","bs_curry","cr:2382"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return!c("bs_belt_Option").isNone(a.replySourceId)}function e(a){a=a.replyToUserId;if(a!==void 0)return c("bs_caml_format").caml_int64_of_string(c("bs_caml_option").valFromOption(a))}function f(a){var b=a.isForwarded,e=!c("bs_belt_Option").isNone(a.replySourceId),f=a.isStoryReply;a=a.isStoryShare;if(b)return d("LSMessageReplySourceTypeV2.bs").forward;if(a!==void 0&&a)return d("LSMessageReplySourceTypeV2.bs").fbStoryShare;if(e)if(f!==void 0&&f)return d("LSMessageReplySourceTypeV2.bs").story;else return d("LSMessageReplySourceTypeV2.bs").message}function h(a){var b=!c("bs_belt_Option").isNone(a.replySourceId),e=a.isStoryReply;a=a.isStoryShare;if(a!==void 0&&a)return d("LSMessageReplySourceTypeV2.bs").fbStoryShare;if(b)if(e!==void 0&&e)return d("LSMessageReplySourceTypeV2.bs").story;else return d("LSMessageReplySourceTypeV2.bs").message}function i(a){if(!c("bs_belt_Option").isNone(a.replySourceId))return a.replySourceId}function j(a){if(!c("bs_belt_Option").isNone(a.replySourceId))return a.replyMessageText}function k(a){if(c("bs_belt_Option").isNone(a.replySourceId))return!1;else return c("bs_belt_Option").isSome(a.replyMediaUrlMimeType)}function l(a){if(k(a))return a.replyMediaUrlMimeType}function m(a){if(k(a))return c("bs_belt_Option").map(a.replyMediaPreviewHeight,c("bs_caml_int64").of_int32)}function n(a){if(k(a))return c("bs_belt_Option").map(a.replyMediaPreviewWidth,c("bs_caml_int64").of_int32)}function o(a){var e=a.replyMessageText;e=e!==void 0?b("cr:2382")==null?e:c("bs_curry")._1(b("cr:2382").unvault,e):"";e=e==="\ud83d\udc4d"&&a.replyStatusType==="Sticker"&&d("MAWGating").isHotLikeEnabled();var f=k(a);a=a.replyStatusType;if(f){if(a===void 0)return;switch(a){case"Gif":if(e)return;else return d("LSReplyMessageAttachmentType.bs").gif;case"Ptt":if(e)return;else return d("LSReplyMessageAttachmentType.bs").other;case"Sticker":if(!e)return d("LSReplyMessageAttachmentType.bs").sticker;break;case"Video":if(e)return;else return d("LSReplyMessageAttachmentType.bs").video;case"Image":case"XMA":if(e)return;else return d("LSReplyMessageAttachmentType.bs").photo;default:}}if(a!==void 0&&a==="Sticker"&&e)return d("LSReplyMessageAttachmentType.bs").sticker}function p(a){var b=k(a),e=a.replyMediaId;a=a.replyXMAId;if(b&&e!==void 0)if(a!==void 0)return;else return c("bs_belt_Option").map(e,d("MAWMedia.bs").mediaIdToIntExn);if(e!==void 0||a===void 0)return;else return c("bs_belt_Option").map(a,d("MAWXMA.bs").xmaIdToIntExn)}function q(a){var b=a.replyStatusType,d=o(a),e=p(a),f=a.replyMessageText;a=a.isStoryReply;if(b!==void 0&&b==="XMA"&&d===void 0){if(e!==void 0)return;if(f===void 0)return c("bs_caml_int64").zero}if(e!==void 0||!(a!==void 0&&a))return;else return c("bs_caml_int64").zero}g.$MAWVault$requireCond=b("cr:2382");g.hasReply=a;g.getReplyUserId=e;g.getReplySourceTypeV2=f;g.getReplySourceType=h;g.getReplySourceId=i;g.getReplyMessageText=j;g.hasReplyMedia=k;g.getReplyMediaMimeType=l;g.getReplyMediaHeight=m;g.getReplyMediaWidth=n;g.getReplyAttachmentType=o;g.getReplyAttachmentId=p;g.getReplyMediaExpirationTimestampMs=q}),98);
__d("MAWBridgeNewMsgHandler.bs",["LSAuthorityLevel.bs","LSHotEmojiSize.bs","LSIntEnum","LSMessageUnsendabilityStatus.bs","LSMessageViewFlag.bs","LSQuickReplyType.bs","MAWAckLevel.bs","MAWAdminMsgCTA.bs","MAWBridgeBuildAdminMsg","MAWBridgeBuildMsgMentions","MAWMsg.bs","MAWMsgReply","MAWMsgReply.bs","MAWThreadId.bs","MAWTimeUtils","MAWUpdateMsg","MAWVault","Promise","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.specialTextSize;if(c("bs_caml_obj").caml_equal(a,1))return d("LSHotEmojiSize.bs").small;else if(c("bs_caml_obj").caml_equal(a,2))return d("LSHotEmojiSize.bs").medium;else if(c("bs_caml_obj").caml_equal(a,3))return d("LSHotEmojiSize.bs").large;else return d("LSHotEmojiSize.bs").none}function i(a,c,e,f){var g=e.adminContent,h=e.adminType,i=e.adminVersion,j=e.chatId,k=e.content,l=e.isAdminMessage,m=e.mentionedJids,n=e.msgId;if(l&&g!=null&&h!=null)return d("MAWBridgeBuildAdminMsg").buildAdminMsgText(a,c,j,f,n,g,h,i);return k!=null&&k!==""&&m!=null&&m.length!==0?d("MAWBridgeBuildMsgMentions").buildMsgTextWithMentions(a,c,n,d("MAWVault").unvault(k),m,function(b){return d("MAWUpdateMsg").mutateThreadText(a,j,f,n,d("MAWVault").vault(b))}).then(d("MAWVault").vault):b("Promise").resolve(k)}function j(a,b,e,f,g,j){var k=g==null?void 0:g.ctaType,l=g==null?void 0:g.title,m=g==null?void 0:g.ctaId,n=d("MAWTimeUtils").toTimestamp(f.type_===d("MAWMsg.bs").unsent?c("bs_belt_Option").getWithDefault(f.originalTs,f.ts):f.ts);return i(a,b,f,n).then(function(a){var g=f.ephemeralDurationInSec,i=d("MAWMsgReply").getReplyStatus(f);return b.table("messages").add({adminMsgCtaId:m,adminMsgCtaTitle:l,adminMsgCtaType:k,authorityLevel:d("LSAuthorityLevel.bs").authoritative,cannotUnsendReason:f.type_===d("MAWMsg.bs").unsent||!f.isAuthorMe?d("LSMessageUnsendabilityStatus.bs").denyForNonSender:void 0,displayedContentTypes:d("MAWMsg.bs").getDisplayedContentTypes(f.type_,f.isForwarded,f.isExpiredXmaMsg),ephemeralDurationInSec:g!==void 0?c("bs_caml_int64").of_int32(g):void 0,ephemeralExpirationTs:void 0,replyStatus:i!=null?d("LSIntEnum").ofNumber(i):void 0,forwardScore:void 0,hasQuickReplies:!1,hotEmojiSize:h(f),isAdminMessage:f.isAdminMessage,isForwarded:void 0,isUnsent:f.type_===d("MAWMsg.bs").unsent,localDataId:void 0,mentionIds:void 0,mentionLengths:void 0,mentionOffsets:void 0,mentionTypes:void 0,messageId:f.msgId,msUntilExpirationTs:void 0,offlineThreadingId:f.msgId,primarySortKey:c("bs_caml_int64").of_float(f.sortOrderMs),quickReplyType:d("LSQuickReplyType.bs").none,replyAttachmentExtra:void 0,replyAttachmentId:d("MAWMsgReply.bs").getReplyAttachmentId(f),replyAttachmentType:d("MAWMsgReply.bs").getReplyAttachmentType(f),replyCtaId:void 0,replyCtaTitle:void 0,replyMediaExpirationTimestampMs:d("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(f),replyMediaPreviewHeight:d("MAWMsgReply.bs").getReplyMediaHeight(f),replyMediaPreviewWidth:d("MAWMsgReply.bs").getReplyMediaWidth(f),replyMediaUrl:void 0,replyMediaUrlFallback:void 0,replyMediaUrlMimeType:d("MAWMsgReply.bs").getReplyMediaMimeType(f),replyMessageText:d("MAWMsgReply.bs").getReplyMessageText(f),replySnippet:j,replySourceId:d("MAWMsgReply.bs").getReplySourceId(f),replySourceTimestampMs:void 0,replySourceType:d("MAWMsgReply.bs").getReplySourceType(f),replySourceTypeV2:d("MAWMsgReply.bs").getReplySourceTypeV2(f),replyToUserId:d("MAWMsgReply.bs").getReplyUserId(f),replyType:void 0,secondarySortKey:void 0,senderId:c("bs_caml_format").caml_int64_of_string(f.sender),sendStatus:d("MAWAckLevel.bs").levelToMessagingSendStatus(f.ack),sendStatusV2:d("MAWAckLevel.bs").levelToMessagingSendStatusV2(f.ack),stickerId:void 0,subscriptErrorMessage:void 0,takedownState:void 0,text:(g=a)!=null?g:void 0,textHasLinks:!1,threadKey:e,timestampMs:n,unsentTimestampMs:d("MAWTimeUtils").toTimestamp(f.ts),viewedPluginContext:void 0,viewedPluginKey:void 0,viewFlags:d("LSMessageViewFlag.bs").uncalculated})})}function k(a,e,f){return d("MAWThreadId.bs").toThreadKeyMaybe(e,f.chatId).then(function(g){return g==null?b("Promise").resolve():d("MAWAdminMsgCTA.bs").getAdminMsgCtaStep(e,g,f).then(function(b){return d("MAWMsgReply").getReplySnippet(a,e,f).then(function(a){return[b,a]})}).then(function(g){var i=g[0],k=g[1];g=f.offlineMsg;if(g==null)return j(a,e,i.threadKey,f,i.result,k);var b=i.threadKey,l=i.result;i=l!==void 0?[l.ctaId,l.title,l.ctaType]:[void 0,void 0,void 0];var m=i[0],n=i[1],o=i[2];return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("messages")),{hd:b,tl:{hd:c("bs_caml_int64").of_float(g.ts),tl:{hd:g.msgId,tl:0}}})).then(function(g){if(g==null)return j(a,e,b,f,l,k);var i=f.ephemeralDurationInSec;g=babelHelpers["extends"]({},g,{ephemeralDurationInSec:i!==void 0?c("bs_caml_int64").of_int32(i):void 0,replySourceTimestampMs:void 0,authorityLevel:d("LSAuthorityLevel.bs").authoritative,hotEmojiSize:h(f),displayedContentTypes:d("MAWMsg.bs").getDisplayedContentTypes(f.type_,f.isForwarded,f.isExpiredXmaMsg),adminMsgCtaType:o,adminMsgCtaTitle:n,adminMsgCtaId:m,replyAttachmentId:d("MAWMsgReply.bs").getReplyAttachmentId(f),replyAttachmentType:d("MAWMsgReply.bs").getReplyAttachmentType(f),replyMediaUrlMimeType:d("MAWMsgReply.bs").getReplyMediaMimeType(f),replyMediaPreviewHeight:d("MAWMsgReply.bs").getReplyMediaHeight(f),replyMediaPreviewWidth:d("MAWMsgReply.bs").getReplyMediaWidth(f),replyMediaUrl:void 0,replyMediaExpirationTimestampMs:d("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(f),replyToUserId:d("MAWMsgReply.bs").getReplyUserId(f),replyMessageText:d("MAWMsgReply.bs").getReplyMessageText(f),replySnippet:k,replyStatus:c("bs_belt_Option").map(d("MAWMsgReply").getReplyStatus(f),c("bs_caml_int64").of_int32),replySourceTypeV2:d("MAWMsgReply.bs").getReplySourceTypeV2(f),replySourceType:d("MAWMsgReply.bs").getReplySourceType(f),replySourceId:d("MAWMsgReply.bs").getReplySourceId(f),isUnsent:f.type_===d("MAWMsg.bs").unsent,sendStatusV2:d("MAWAckLevel.bs").levelToMessagingSendStatusV2(f.ack),sendStatus:d("MAWAckLevel.bs").levelToMessagingSendStatus(f.ack),messageId:f.msgId,primarySortKey:c("bs_caml_int64").of_float(f.sortOrderMs),timestampMs:d("MAWTimeUtils").toTimestamp(f.ts)});return e.table("messages").put(g)})})}).then(function(a){})}function a(a,c,d){return b("Promise").all(d.filter(function(a){return!a.isDualSend}).map(function(b){return k(a,c,b)})).then(function(a){})}g.getSpecialTextSize=h;g.call=k;g.bulkCall=a}),98);
__d("MAWBridgeMsgUpdatedHandler.bs",["LSMessageUnsendabilityStatus.re","MAWAckLevel.bs","MAWAdminMsg.bs","MAWAdminMsgCTA.bs","MAWBridgeNewMsgHandler.bs","MAWMsg.bs","MAWMsgReply","MAWMsgReply.bs","MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_belt_Option","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f){return d("MAWThreadId.bs").toThreadKeyMaybe(e,f.chatId).then(function(g){return g==null?b("Promise").resolve():d("MAWAdminMsgCTA.bs").getAdminMsgCtaStep(e,g,f).then(function(g){return d("MAWMsgReply").getReplySnippet(a,e,f).then(function(a){return[g,a]}).then(function(h){var g=h[0],a=g.threadKey;g=g.result;var i=h[1],j=f.type_===d("MAWMsg.bs").unsent;h=g!==void 0?[g.ctaId,g.title,g.ctaType]:[void 0,void 0,void 0];var k=h[0],l=h[1],m=h[2];return d("ReQL.bs").first(d("ReQL.bs").filter(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("messages")),{hd:a,tl:0}),function(a){return a.messageId===f.msgId})).then(function(a){if(a===void 0)return b("Promise").resolve();var g=d("MAWAckLevel.bs").levelToMessagingSendStatusV2(f.ack);if(f.isAdminMessage){var h=f.adminContent,n=f.adminType;h=h!==void 0&&n!==void 0?d("MAWAdminMsg.bs").buildLocalizedString(h,[],n):void 0}else h=f.content;n=babelHelpers["extends"]({},a,{replySourceTimestampMs:void 0,unsentTimestampMs:j?d("MAWTimeUtils").toTimestamp(f.ts):void 0,hotEmojiSize:d("MAWBridgeNewMsgHandler.bs").getSpecialTextSize(f),displayedContentTypes:d("MAWMsg.bs").getDisplayedContentTypes(f.type_,f.isForwarded,f.isExpiredXmaMsg),cannotUnsendReason:j||!f.isAuthorMe?d("LSMessageUnsendabilityStatus.re").denyForNonSender:void 0,adminMsgCtaType:m,adminMsgCtaTitle:l,adminMsgCtaId:k,replyAttachmentExtra:void 0,replyAttachmentId:d("MAWMsgReply.bs").getReplyAttachmentId(f),replyAttachmentType:d("MAWMsgReply.bs").getReplyAttachmentType(f),replyMediaUrlMimeType:d("MAWMsgReply.bs").getReplyMediaMimeType(f),replyMediaPreviewHeight:d("MAWMsgReply.bs").getReplyMediaHeight(f),replyMediaPreviewWidth:d("MAWMsgReply.bs").getReplyMediaWidth(f),replyMediaUrl:void 0,replyMediaExpirationTimestampMs:d("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(f),replyToUserId:d("MAWMsgReply.bs").getReplyUserId(f),replyMessageText:d("MAWMsgReply.bs").getReplyMessageText(f),replySnippet:i,replyStatus:c("bs_belt_Option").map(d("MAWMsgReply").getReplyStatus(f),c("bs_caml_int64").of_int32),replySourceTypeV2:d("MAWMsgReply.bs").getReplySourceTypeV2(f),replySourceType:d("MAWMsgReply.bs").getReplySourceType(f),replySourceId:d("MAWMsgReply.bs").getReplySourceId(f),isUnsent:j,sendStatusV2:g,sendStatus:d("MAWAckLevel.bs").levelToMessagingSendStatus(f.ack),text:h,primarySortKey:c("bs_caml_int64").of_float(f.sortOrderMs),timestampMs:d("MAWTimeUtils").toTimestamp(j?c("bs_belt_Option").getWithDefault(f.originalTs,f.ts):f.ts)});return e.table("messages").put(n)})})})})}g.call=a}),98);
__d("MAWBridgeMsgsLoadedHandler.bs",["LS.bs","LSClearMessagePlaceholderRange","LSInsertNewMessageRange","MAWThreadId.bs","MAWTimeUtils.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f!==void 0)return c("LSClearMessagePlaceholderRange")(f,"",d("MAWTimeUtils.bs").maxTimestampMs,d("LS.bs").make(a)).then(function(b){b=e.rangeExtensionType;var g;switch(b.TAG){case 1:case 2:g=c("bs_caml_int64").of_float(b._0.minMsgTs);break;case 0:case 3:g=d("MAWTimeUtils.bs").minTimestampMs;break}b=e.rangeExtensionType;b=b.TAG===3?c("bs_caml_int64").of_float(b._0.maxMsgTs):d("MAWTimeUtils.bs").maxTimestampMs;var h=e.rangeExtensionType,i;switch(h.TAG){case 1:case 2:i=h._0.minMsgId;break;case 0:case 3:i="";break}h=e.rangeExtensionType;var j;switch(h.TAG){case 1:j=h._0.maxMsgId;break;case 0:case 2:j="";break;case 3:j=h._0.maxMsgId;break}h=e.rangeExtensionType;var k;switch(h.TAG){case 1:case 2:k=c("bs_caml_int64").of_float(h._0.minMsgTs);break;case 0:case 3:k=d("MAWTimeUtils.bs").minTimestampMs;break}h=e.rangeExtensionType;h=h.TAG===3?c("bs_caml_int64").of_float(h._0.maxMsgTs):d("MAWTimeUtils.bs").maxTimestampMs;var l=e.rangeExtensionType,m;switch(l.TAG){case 1:m=l._0.hasMoreBefore;break;case 2:m=l._0.hasMoreBefore;break;case 0:case 3:m=!1;break}l=e.rangeExtensionType;l=l.TAG===3?l._0.hasMoreAfter:!1;return c("LSInsertNewMessageRange")(f,g,b,i,j,k,h,m,l,void 0,d("LS.bs").make(a))});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeMsgsStartCountdownHandler.bs",["MAWEphemeralMessageExpirationStorage.bs","MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return e.msgs.reduce(function(e,f){return e.then(function(e){d("MAWEphemeralMessageExpirationStorage.bs").setMessageForExpiration(a,f,f.countdownTs,f.millisecondsUntilCountdownTs);c("bs_caml_int64").of_int32(f.millisecondsUntilCountdownTs);return d("MAWThreadId.bs").toThreadKeyMaybe(a,f.chatId).then(function(e){if(e!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("messages")),{hd:e,tl:{hd:d("MAWTimeUtils").toTimestamp(f.ts),tl:{hd:f.msgId,tl:0}}})).then(function(d){if(d===void 0)return b("Promise").resolve();d=babelHelpers["extends"]({},d,{ephemeralExpirationTs:c("bs_caml_int64").of_float(f.countdownTs)});return a.table("messages").put(d)});else return b("Promise").resolve()})})},b("Promise").resolve())}g.call=a}),98);
__d("MAWBridgeNewMediaHandler.bs",["MAWDbMsg","MAWMedia.bs","MAWThreadId.bs","Promise","ReQLTable.bs","bs_belt_Option","bs_caml_int64","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=String(e.mediaId);return e.msgIds.reduce(function(b,h){return b.then(function(b){var i=c("bs_caml_int64").of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(h));return d("ReQLTable.bs").update(a.table("attachments"),{hd:f,tl:{hd:h,tl:{hd:g,tl:0}}},function(a){return a===void 0?{accessibilitySummaryText:void 0,actionUrl:void 0,attachmentCta1Id:void 0,attachmentCta2Id:void 0,attachmentCta3Id:void 0,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,attachmentLoggingType:void 0,attachmentType:d("MAWMedia.bs").mediaTypeToMessageAttachmentType(e.mediaType),attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,attributionAppId:void 0,attributionAppName:void 0,authorityLevel:c("bs_caml_int64").zero,avatarCount:void 0,avatarViewAccessibilityLabel:void 0,avatarViewSize:void 0,avatarViewTitleList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewUrlList:void 0,captionBodyText:void 0,cta1Title:void 0,cta1Type:void 0,cta2Title:void 0,cta2Type:void 0,cta3Title:void 0,cta3Type:void 0,dashManifest:void 0,decryptionKey:void 0,defaultCtaId:void 0,defaultCtaTitle:void 0,defaultCtaType:void 0,descriptionText:void 0,ephemeralMediaState:void 0,faviconUrl:void 0,faviconUrlExpirationTimestampMs:void 0,faviconUrlFallback:void 0,filename:void 0,filesize:c("bs_belt_Option").map(e.filesize,c("bs_caml_int64").of_int32),gatingTitle:void 0,gatingType:void 0,hasMedia:e.hasMedia,hasXma:!1,headerImageUrl:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlFallback:void 0,headerImageUrlMimeType:void 0,headerTitle:void 0,imageUrl:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlFallback:void 0,imageUrlMimeType:void 0,isBorderless:void 0,isPreviewImage:void 0,isSharable:!1,listItemAccessibilityText1:void 0,listItemAccessibilityText2:void 0,listItemAccessibilityText3:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList1:void 0,listItemContactUrlFallbackList2:void 0,listItemContactUrlFallbackList3:void 0,listItemContactUrlList1:void 0,listItemContactUrlList2:void 0,listItemContactUrlList3:void 0,listItemId1:void 0,listItemId2:void 0,listItemId3:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrlFallback3:void 0,listItemProgressBarFilledPercentage1:void 0,listItemProgressBarFilledPercentage2:void 0,listItemProgressBarFilledPercentage3:void 0,listItemsDescriptionSubtitleText:void 0,listItemsDescriptionText:void 0,listItemsId:void 0,listItemsSecondaryDescriptionText:void 0,listItemTitleText1:void 0,listItemTitleText2:void 0,listItemTitleText3:void 0,localPlayableUrl:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,messageId:h,miniPreview:void 0,offlineAttachmentId:g,originalFileHash:void 0,originalPageSenderId:void 0,playableDurationMs:c("bs_belt_Option").map(c("bs_caml_option").nullable_to_opt(e.duration),c("bs_caml_int64").of_int32),playableUrl:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlFallback:void 0,playableUrlMimeType:void 0,preheaderText:void 0,previewHeight:c("bs_belt_Option").map(c("bs_caml_option").nullable_to_opt(e.previewHeight),c("bs_caml_int64").of_int32),previewHeightLarge:c("bs_belt_Option").map(c("bs_caml_option").nullable_to_opt(e.previewHeightLarge),c("bs_caml_int64").of_int32),previewImageDecorationType:void 0,previewUrl:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlFallback:void 0,previewUrlLarge:void 0,previewUrlMimeType:void 0,previewWidth:c("bs_belt_Option").map(c("bs_caml_option").nullable_to_opt(e.previewWidth),c("bs_caml_int64").of_int32),previewWidthLarge:c("bs_belt_Option").map(c("bs_caml_option").nullable_to_opt(e.previewWidthLarge),c("bs_caml_int64").of_int32),samplingFrequencyHz:void 0,shouldAutoplayVideo:void 0,shouldHighlightHeaderTitleInTitle:void 0,shouldRespectServerPreviewSize:void 0,sourceText:void 0,subtitleIconUrl:void 0,subtitleText:void 0,targetId:void 0,threadKey:f,timestampMs:i,titleText:void 0,viewerSeenTimestampMs:void 0,waveformData:void 0,xmaLayoutType:void 0,xmasTemplateType:void 0}:babelHelpers["extends"]({},a,{hasMedia:e.hasMedia})})})},b("Promise").resolve())})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeNewMediaRangeHandler.bs",["LS.bs","LSThreadMediaGalleryGroup.bs","LSUpsertAttachmentRange","MAWThreadId.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_int64").of_int32(e.minMsgRowId),h=e.hasMoreBefore;return c("LSUpsertAttachmentRange")(f,d("LSThreadMediaGalleryGroup.bs").photosAndVideos,g,h,d("LS.bs").make(a))})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeOneToOneMessageRequestLoadedHandler.bs",["fbt","LSAuthorityLevel.bs","LSMessagingThreadTypeUtil.bs","LSThreadBitOffset.bs","MAWContact.bs","MAWGating","MAWMessageRequestUtil.bs","MAWThreadId.bs","Promise","ReQL.bs","bs_caml","bs_caml_format","bs_caml_int64"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:f,tl:0})).then(function(f){if(f===void 0)return b("Promise").resolve([void 0,void 0,void 0,!1]);var g=d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:c("bs_caml_format").caml_int64_of_string(e.fbid),tl:0}));return b("Promise").all([b("Promise").resolve(f),g,b("Promise").resolve(e.relationship),b("Promise").resolve(d("LSMessagingThreadTypeUtil.bs").isOneToOne(f.threadType))])}).then(function(e){var f=e[0];if(f===void 0)return b("Promise").resolve();var g=e[1];if(g===void 0)return b("Promise").resolve();var i=e[2];if(i===void 0)return b("Promise").resolve();if(!e[3])return b("Promise").resolve();e=c("bs_caml").i64_neq(g.authorityLevel,d("LSAuthorityLevel.bs").authoritative)?i:d("MAWContact.bs").lsContactToContactRelationshipType(g);if(f.folderName==="pending"||f.folderName==="other"||f.folderName==="spam"||f.folderName==="inbox"&&e!==d("MAWContact.bs").twoWayContact&&e!==d("MAWContact.bs").oneWayContact&&c("bs_caml").i64_neq(f.lastActivityTimestampMs,c("bs_caml_int64").zero)){i=d("LSThreadBitOffset.bs").clear(d("MAWMessageRequestUtil.bs").disabledThreadCapabilitiesForIncomingRequest,f.capabilities,f.capabilities2,f.capabilities3);g=d("MAWGating").isEyebrowTextEnabled()&&f.folderName==="inbox"?h._("__JHASH__4F6x7gUU1-S__JHASH__").toString():void 0;e=[d("LSThreadBitOffset.bs").set(d("MAWMessageRequestUtil.bs").enabledThreadCapabilitiesForIncomingRequest,i[0],i[1],i[2]),g]}else e=[[f.capabilities,f.capabilities2,f.capabilities3],void 0];i=e[0];g=babelHelpers["extends"]({},f,{capabilities3:i[2],capabilities2:i[1],additionalThreadContext:e[1],capabilities:i[0]});return a.table("threads").put(g).then(function(a){})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeParticipantRemovedHandler.bs",["MAWThreadId.bs","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(d){if(d===void 0)return b("Promise").resolve();var f=c("bs_caml_format").caml_int64_of_string(e.fbid);return a.table("participants")["delete"]({hd:d,tl:{hd:f,tl:0}}).then(function(a){})})}g.call=a}),98);
__d("MAWBridgeParticipantUpdatedHandler.bs",["fbt","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSGroupParticipantJoinState.bs","LSVerifyContactRowExists","MAWCurrentUser","MAWThreadId.bs","MAWTimeUtils","MAWUpdateLSThreadCapabilities.bs","Promise","ReQLTable.bs","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("MAWCurrentUser").getID(),j=c("bs_caml_format").caml_int64_of_string(i);function a(a){return a.startsWith("shadow_")}function e(a,e){if(e.fbid.startsWith("shadow_"))return b("Promise").resolve();else return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.fbid),k=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),l=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),m=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),n=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,o={contents:!1},p={contents:!1};return d("ReQLTable.bs").update(a.table("participants"),{hd:f,tl:{hd:g,tl:0}},function(a){if(a!==void 0){p.contents=!0;return{authorityLevel:a.authorityLevel,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:m,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}else{p.contents=!0;o.contents=!0;return{authorityLevel:c("bs_caml_int64").zero,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:c("bs_caml_int64").zero,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}}).then(function(h){if(p.contents)return d("MAWUpdateLSThreadCapabilities.bs").disableBlockerCapabilitiesTxn(a,f).then(function(b){b=c("bs_caml").i64_eq(j,g);var h=e.isAdmin;if(b)if(h)return d("MAWUpdateLSThreadCapabilities.bs").enableAddMembersTxn(a,f);else return d("MAWUpdateLSThreadCapabilities.bs").disableAddMembersTxn(a,f);else return window.Promise.resolve()});else return b("Promise").resolve()}).then(function(f){if(o.contents)return c("LSVerifyContactRowExists")(g,d("LSContactIdType.bs").fbid,void 0,void 0,d("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,d("LSContactBlockedByViewerStatus.bs").unblocked,void 0,c("bs_caml_obj").caml_equal(i,e.fbid),d("LSAuthorityLevel.bs").optimistic,void 0,void 0,d("LSContactWorkForeignEntityType.bs").unknown,d("LSContactGender.bs").unknown,d("LSContactViewerRelationship.bs").unknown,void 0,d("LS.bs").make(a));else return b("Promise").resolve()})})}g.currentUserId=i;g.currentUserIdAsInt64=j;g.checkIfDualSendUser=a;g.call=e}),98);
__d("MAWBridgeParticipantsUpdatedHandler.bs",["fbt","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSGroupParticipantJoinState.bs","LSVerifyContactRowExists","MAWCurrentUser","MAWThreadId.bs","MAWTimeUtils","MAWUpdateLSThreadCapabilities.bs","Promise","ReQLTable.bs","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("MAWCurrentUser").getID(),j=c("bs_caml_format").caml_int64_of_string(i);function a(a){return a.startsWith("shadow_")}function e(a,e){e=e.participants.filter(function(a){return!a.fbid.startsWith("shadow_")});return b("Promise").all(e.map(function(e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.fbid),k=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),l=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),m=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),n=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,o={contents:!1},p={contents:!1};return d("ReQLTable.bs").update(a.table("participants"),{hd:f,tl:{hd:g,tl:0}},function(a){if(a!==void 0){p.contents=!0;return{authorityLevel:a.authorityLevel,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:m,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}else{p.contents=!0;o.contents=!0;return{authorityLevel:c("bs_caml_int64").zero,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:c("bs_caml_int64").zero,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}}).then(function(h){if(p.contents)return d("MAWUpdateLSThreadCapabilities.bs").disableBlockerCapabilitiesTxn(a,f).then(function(b){b=c("bs_caml").i64_eq(j,g);var h=e.isAdmin;if(b)if(h)return d("MAWUpdateLSThreadCapabilities.bs").enableAddMembersTxn(a,f);else return d("MAWUpdateLSThreadCapabilities.bs").disableAddMembersTxn(a,f);else return window.Promise.resolve()});else return b("Promise").resolve()}).then(function(f){if(o.contents)return c("LSVerifyContactRowExists")(g,d("LSContactIdType.bs").fbid,void 0,void 0,d("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,d("LSContactBlockedByViewerStatus.bs").unblocked,void 0,c("bs_caml_obj").caml_equal(i,e.fbid),d("LSAuthorityLevel.bs").optimistic,void 0,void 0,d("LSContactWorkForeignEntityType.bs").unknown,d("LSContactGender.bs").unknown,d("LSContactViewerRelationship.bs").unknown,void 0,d("LS.bs").make(a));else return b("Promise").resolve()})})})).then(function(a){})}g.currentUserId=i;g.currentUserIdAsInt64=j;g.checkIfDualSendUser=a;g.call=e}),98);
__d("MAWBridgeReactionUpsertHandler.bs",["LSAuthorityLevel.bs","MAWThreadId.bs","MAWTimeUtils","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f!==void 0)return a.table("reactions").upsert({hd:f,tl:{hd:e.messageId,tl:{hd:c("bs_caml_format").caml_int64_of_string(e.actorId),tl:0}}},{actorId:c("bs_caml_format").caml_int64_of_string(e.actorId),authorityLevel:d("LSAuthorityLevel.bs").authoritative,messageId:e.messageId,reaction:e.reaction,threadKey:f,timestampMs:d("MAWTimeUtils").toTimestamp(e.ts)});else return b("Promise").resolve()})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeReceivedChatStateHandler.bs",["MAWThreadId.bs","Promise","ServerTime","WAChatState","bs_caml_format","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.senderId),h=c("bs_caml_int64").of_float(3e3+d("ServerTime").getMillis());if(e.state===d("WAChatState").TYPING)return a.table("typing_indicator").upsert({hd:f,tl:{hd:g,tl:0}},{expirationTimestampMs:h,senderId:g,threadKey:f}).then(function(a){});else if(e.state===d("WAChatState").IDLE)return a.table("typing_indicator")["delete"]({hd:f,tl:{hd:g,tl:0}}).then(function(a){});else return window.Promise.resolve()})}g.call=a}),98);
__d("MAWBridgeReceivedReceiptHandler.bs",["MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.fbid),h=d("MAWTimeUtils").toTimestamp(e.lastReadWatermarkTs),i=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),j=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs);return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("participants")),{hd:f,tl:{hd:g,tl:0}})).then(function(c){if(c!==void 0)return a.table("participants").put({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:j,readWatermarkTimestampMs:h,subscribeSource:c.subscribeSource,threadKey:c.threadKey});else return b("Promise").resolve()}).then(function(a){})})}g.call=a}),98);
__d("MAWBridgeSyncContacts.bs",["CurrentUser","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSVerifyContactRowExists","Promise","bs_caml_format","bs_caml_obj"],(function(a,b,c,d,e,f,g){"use strict";var h=c("CurrentUser").getID();function a(a,e){return e.reduce(function(b,e){var f=c("bs_caml_format").caml_int64_of_string(e);return b.then(function(b){return c("LSVerifyContactRowExists")(f,d("LSContactIdType.bs").fbid,void 0,void 0,d("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,d("LSContactBlockedByViewerStatus.bs").unblocked,void 0,c("bs_caml_obj").caml_equal(h,e),d("LSAuthorityLevel.bs").optimistic,void 0,void 0,d("LSContactWorkForeignEntityType.bs").unknown,d("LSContactGender.bs").unknown,d("LSContactViewerRelationship.bs").unknown,void 0,d("LS.bs").make(a))}).then(function(a){})},b("Promise").resolve())}g.currentUserFbid=h;g.call=a}),98);
__d("MAWBridgeBuildThreadSnippet",["MAWAdminMsg","MAWBridgeBuildMsgMentions","MAWLocalizationType","MAWThreadId","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){if(a==null)return b;b=[].concat(b);switch(c){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:b[0]=a;break}return b}function a(a,c,e,f){var g,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:g=e.snippetContactIDs,j=e.snippetMentionJIDs,k=e.snippetParams,l=e.snippetType,m=e.threadId;if(!(k==null||l==null||g==null)){q.next=3;break}return q.abrupt("return",f);case 3:q.next=5;return b("regeneratorRuntime").awrap(d("MAWBridgeBuildMsgMentions").buildThreadSnippetWithMentions(a,c,m,k[0],j,g,function(b){var c=b[0];b=b[1];c=d("MAWAdminMsg").buildLocalizedString(h(c,k,l),b,l);return i(a,m,c)}));case 5:n=q.sent;o=n[0];p=n[1];return q.abrupt("return",d("MAWAdminMsg").buildLocalizedString(h(o,k,l),p,l));case 9:case"end":return q.stop()}},null,this)}function i(a,c,e){return a.runInTransaction(function(f){var g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c));case 2:g=j.sent;if(!(g==null)){j.next=5;break}return j.abrupt("return");case 5:h=f.table("threads");j.next=8;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(h).getKeyRange(g)));case 8:i=j.sent;if(!i){j.next=12;break}j.next=12;return b("regeneratorRuntime").awrap(h.put(babelHelpers["extends"]({},i,{snippet:e})));case 12:case"end":return j.stop()}},null,this)},"readwrite")}g.buildBridgeThreadSnippet=a;g.mutateThreadSnippet=i}),98);
__d("MAWBridgeBuildThreadSnippet.bs",["MAWBridgeBuildThreadSnippet"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){return d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,b,c,e)}function b(a,b,c){d("MAWBridgeBuildThreadSnippet").mutateThreadSnippet(a,b,c)}g.buildBridgeThreadSnippet=a;g.mutateThreadSnippet=b}),98);
__d("MWV2DualSendMessageContent.bs",["MAWVault.bs"],(function(a,b,c,d,e,f,g){"use strict";var h="8031ded1058446aa93ccf8dace0eaf876dd5e32771904d5eb0058a0afdc724ce120dcba542d84548ac3f4a2741c45c0d",i="9031ded1058446aa93ccf8dace0eaf876dd5e32771904d5eb0058a0afdc724ce120dcba542d84548ac3f4a2741c45c0d";function a(a){if(a===void 0)return!1;a=d("MAWVault.bs").unvault(a);if(a.endsWith(h))return!0;else return a.endsWith(i)}g.messageText=h;g.messageTextV2=i;g.isDualSend=a}),98);
__d("MAWBridgeThreadBumpedHandler.bs",["MAWBridgeBuildThreadSnippet.bs","MAWBumpThread.bs","MAWThreadId.bs","MAWTimeUtils","MWV2DualSendMessageContent.bs","Promise","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f){return d("MAWThreadId.bs").toThreadKeyMaybe(e,f.threadId).then(function(g){if(g!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("threads")),{hd:g,tl:0})).then(function(h){if(h!==void 0)return d("MAWBridgeBuildThreadSnippet.bs").buildBridgeThreadSnippet(a,e,f).then(function(a){var h=d("MWV2DualSendMessageContent.bs").isDualSend(a),i=d("MAWTimeUtils").millisTimeToTimestamp(f.lastActivityTs);i=d("MAWBumpThread.bs").threadMutation(e,g,i,d("MAWTimeUtils").millisTimeToTimestamp(f.lastReadTs),a,c("bs_belt_Option").mapWithDefault(c("bs_caml_option").nullable_to_opt(f.snippetSenderContactId),void 0,function(a){return c("bs_caml_format").caml_int64_of_string(a)}));if(h)return b("Promise").resolve();else return i.then(function(a){})});else return b("Promise").resolve()});else return b("Promise").resolve()}).then(function(a){})}g.call=a}),98);
__d("MAWBridgeThreadBumpedServerHandler",["I64","LS.re","LSBumpE2EEMetadataThread","MAWGating","MAWThreadId","MAWTimeUtils","WALoggerDeferred","promiseDone","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread on server. threadKey: ",", bumpTimestampMs: ",", isLocalDeviceSend: ",""]);h=function(){return a};return a}function a(a,e){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:if(!(!d("MAWGating").isOccamadillo()||e.isDualSend)){b.next=2;break}return b.abrupt("return");case 2:return b.abrupt("return",d("MAWThreadId").toThreadKeyMaybe(a,e.threadId).then(function(b){if(b==null)return;var f=e.lastActivityTs;f=d("MAWTimeUtils").millisTimeToTimestamp(f);c("promiseDone")(d("WALoggerDeferred").LOG(h(),d("I64").to_string(b),d("I64").to_string(f),e.isCurrentDeviceSendingMsg));return c("LSBumpE2EEMetadataThread")(b,f,e.isCurrentDeviceSendingMsg,c("LS.re").make(a))}));case 3:case"end":return b.stop()}},null,this)}g.call=a}),98);
__d("MAWBridgeThreadHiddenHandler.bs",["LS.bs","LSOptimisticRemoveThread","LSThreadRemoveType.bs","MAWGating","MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e).then(function(e){if(e===void 0)return b("Promise").resolve();if(!d("MAWGating").isOccamadillo())return a.table("threads")["delete"]({hd:e,tl:0}).then(function(a){});var f=d("LS.bs").make(a);return c("LSOptimisticRemoveThread")(e,d("LSThreadRemoveType.bs").deleteThread,f)})}g.call=a}),98);
__d("MAWBridgeThreadTimestampsHandler.bs",["CurrentUser","MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.threadId).then(function(e){if(e!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:e,tl:0})).then(function(e){if(e===void 0)return b("Promise").resolve();e=babelHelpers["extends"]({},e,{lastReadWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)});return a.table("threads").put(e)});else return b("Promise").resolve()})}function a(a,e){return h(a,e).then(function(f){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(c("CurrentUser").getID());return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("participants")),{hd:f,tl:{hd:g,tl:0}})).then(function(c){if(c!==void 0)return a.table("participants").put({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:c.deliveredWatermarkTimestampMs,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(e.lastActivityTimestampMs),readWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(e.lastReadWatermarkTs),subscribeSource:c.subscribeSource,threadKey:c.threadKey});else return b("Promise").resolve()})})}).then(function(a){})}g.call=a}),98);
__d("MAWBridgeThreadUpdatedHandler.bs",["LSBitOffset.bs","LSThreadCapabilityBitOffset.bs","MAWBridgeBuildThreadSnippet.bs","MAWFolder.bs","MAWFolderTypes","MAWGating","MAWThreadId.bs","MWV2DualSendMessageContent.bs","Promise","ReQL.bs","bs_caml_format","bs_caml_int64","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var e=d("MAWGating").isOccamadillo();if(b!==void 0&&!(e||b!==d("MAWFolderTypes").ARCHIVED))return d("LSBitOffset.bs").clear(c("bs_caml_int64").sub(d("LSThreadCapabilityBitOffset.bs").archiveThread,[0,64]),d("LSBitOffset.bs").set(c("bs_caml_int64").sub(d("LSThreadCapabilityBitOffset.bs").unarchiveThread,[0,64]),a));else return a}function i(a,b){var e=d("MAWGating").isOccamadillo();if(b!==void 0&&!(e||b!==d("MAWFolderTypes").INBOX))return d("LSBitOffset.bs").clear(c("bs_caml_int64").sub(d("LSThreadCapabilityBitOffset.bs").unarchiveThread,[0,64]),d("LSBitOffset.bs").set(c("bs_caml_int64").sub(d("LSThreadCapabilityBitOffset.bs").archiveThread,[0,64]),a));else return a}function j(a,b){if(b!==void 0&&b==="viewer_not_subscribed")return d("LSBitOffset.bs").clear(c("bs_caml_int64").sub(d("LSThreadCapabilityBitOffset.bs").leaveThread,[0,64]),a);else return a}function k(a,e,f){return d("MAWThreadId.bs").toThreadKeyMaybe(e,f.threadId).then(function(g){if(g!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("threads")),{hd:g,tl:0})).then(function(g){if(g!==void 0)return d("MAWBridgeBuildThreadSnippet.bs").buildBridgeThreadSnippet(a,e,f,g.snippet).then(function(a){var b=d("MWV2DualSendMessageContent.bs").isDualSend(a),k=f.snippetSenderContactId;k=k==null?g.snippetSenderContactId:c("bs_caml_format").caml_int64_of_string(k);var l=f.muteExpireTimeMs,m=d("MAWGating").isOccamadillo();m=l!=null&&!m?c("bs_caml_int64").of_float(l):g.muteExpireTimeMs;l=f.folder;var n=d("MAWGating").isOccamadillo();l=l!=null&&!n?d("MAWFolder.bs").messagingFolderTag(f.folder):g.folderName;n=f.folder;var o=d("MAWGating").isOccamadillo();n=n!=null&&!o?d("MAWFolder.bs").systemFolder(f.folder):g.parentThreadKey;o=f.cannotReplyReason;o=o==null?l==="inbox"?void 0:g.cannotReplyReason:o;var p=j(h(i(g.capabilities2,c("bs_caml_option").nullable_to_opt(f.folder)),c("bs_caml_option").nullable_to_opt(f.folder)),o);p=babelHelpers["extends"]({},g,{capabilities2:p,parentThreadKey:n,cannotReplyReason:o,snippetSenderContactId:k,snippet:b?g.snippet:a,muteExpireTimeMs:m,folderName:d("MAWGating").isOccamadillo()?g.folderName:l});return e.table("threads").put(p)});else return b("Promise").resolve()});else return b("Promise").resolve()})}function a(a,b,c){return k(a,b,c).then(function(a){})}g.call=a}),98);
__d("MAWBridgeThreadsLoadedHandler.bs",["MAWFolder.bs","MAWThreadId.bs","MAWTimeUtils","MAWTimeUtils.bs","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f;switch(e.TAG){case 0:f=d("MAWFolder.bs").clientSystemFolder(e._0.folderId);break;case 1:f=d("MAWFolder.bs").clientSystemFolder(e._0.folderId);break;case 2:f=d("MAWFolder.bs").clientSystemFolder(e._0.folderId);break}return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads_ranges_v2__generated")),{hd:f,tl:0})).then(function(g){if(g!==void 0)return a.table("threads_ranges_v2__generated")["delete"]({hd:g.parentThreadKey,tl:{hd:g.minThreadKey,tl:{hd:g.minLastActivityTimestampMs,tl:0}}}).then(function(f){switch(e.TAG){case 0:case 1:break;case 2:var c=e._0;return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.minThreadId).then(function(e){if(e!==void 0)return a.table("threads_ranges_v2__generated").put({hasMoreAfter:g.hasMoreAfter,hasMoreBefore:c.hasMore,isLoadingAfter:g.isLoadingAfter,isLoadingBefore:!1,maxLastActivityTimestampMs:g.maxLastActivityTimestampMs,maxThreadKey:g.maxThreadKey,minLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.minLastActivityTs),minThreadKey:e,parentThreadKey:g.parentThreadKey});else return b("Promise").resolve()})}return a.table("threads_ranges_v2__generated").put({hasMoreAfter:g.hasMoreAfter,hasMoreBefore:g.hasMoreBefore,isLoadingAfter:g.isLoadingAfter,isLoadingBefore:!1,maxLastActivityTimestampMs:g.maxLastActivityTimestampMs,maxThreadKey:g.maxThreadKey,minLastActivityTimestampMs:g.minLastActivityTimestampMs,minThreadKey:g.minThreadKey,parentThreadKey:g.parentThreadKey})});switch(e.TAG){case 0:return a.table("threads_ranges_v2__generated").put({hasMoreAfter:!1,hasMoreBefore:!1,isLoadingAfter:!1,isLoadingBefore:!1,maxLastActivityTimestampMs:d("MAWTimeUtils.bs").maxTimestampMs,maxThreadKey:c("bs_caml_int64").zero,minLastActivityTimestampMs:d("MAWTimeUtils.bs").maxTimestampMs,minThreadKey:c("bs_caml_int64").zero,parentThreadKey:f});case 1:var h=e._0;return b("Promise").all([d("MAWThreadId.bs").toThreadKeyMaybe(a,h.minThreadId),d("MAWThreadId.bs").toThreadKeyMaybe(a,h.maxThreadId)]).then(function(c){var e=c[1];c=c[0];if(c!==void 0&&e!==void 0)return a.table("threads_ranges_v2__generated").add({hasMoreAfter:!1,hasMoreBefore:h.hasMore,isLoadingAfter:!1,isLoadingBefore:!1,maxLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(h.maxLastActivityTs),maxThreadKey:e,minLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(h.minLastActivityTs),minThreadKey:c,parentThreadKey:f});else return b("Promise").resolve()});case 2:return b("Promise").resolve()}})}g.call=a}),98);
__d("MAWBridgeUIEventsWrapper",["MAWBridgeTypesWrapper"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.TAG){case 0:return{tag:"NewMsg",value:d("MAWBridgeTypesWrapper").bridgeMsgToJS(a._0)};case 1:return{tag:"MsgsStartCountdown",value:a._0};case 2:return{tag:"MsgClearCountdown",value:a._0};case 3:return{tag:"DropAllSecureThreads",value:a._0};case 4:return{tag:"VerifyThreadExists",value:a._0};case 5:return{tag:"MsgUpdated",value:d("MAWBridgeTypesWrapper").bridgeMsgToJS(a._0)};case 6:return{tag:"NewMedia",value:a._0};case 7:return{tag:"NewMediaRange",value:a._0};case 8:return{tag:"MediaExpired",value:a._0};case 9:return{tag:"XMAShareExpired",value:a._0};case 10:return{tag:"NewXMA",value:a._0};case 11:return{tag:"XMAShareTombstoned",value:a._0};case 12:return{tag:"ParticipantUpdated",value:a._0};case 13:return{tag:"ParticipantRemoved",value:a._0};case 14:return{tag:"UpdateE2EEMetadataParticipants",value:a._0};case 15:return{tag:"ReceivedReceipt",value:a._0};case 16:return{tag:"ThreadUpdated",value:a._0};case 17:return{tag:"GroupInfoUpdated",value:a._0};case 18:return{tag:"ThreadBumped",value:a._0};case 19:return{tag:"ThreadsLoaded",value:a._0};case 20:return{tag:"ThreadTimestampsUpdated",value:a._0};case 21:return{tag:"MsgsLoaded",value:a._0};case 22:return{tag:"InitSyncComplete",value:a._0};case 23:return{tag:"StartTrace",value:d("MAWBridgeTypesWrapper").bridgeStartTraceDataToJS(a._0)};case 24:return{tag:"UpdateTrace",value:a._0};case 25:return{tag:"ThreadHidden",value:a._0};case 26:return{tag:"SyncContacts",value:a._0};case 27:return{tag:"ReceivedChatState",value:a._0};case 28:return{tag:"ClockSkewUpdated",value:a._0};case 29:return{tag:"ABPropsUpdated",value:a._0};case 30:return{tag:"UpsertReaction",value:a._0};case 31:return{tag:"DeleteReaction",value:a._0};case 32:return{tag:"UploadMessage",value:a._0};case 33:return{tag:"UploadThread",value:a._0};case 34:return{tag:"CallFinishAddDevice",value:a._0};case 35:return{tag:"UploadAttachment",value:a._0};case 36:return{tag:"ResignAttachmentCDNUrl",value:a._0};case 37:return{tag:"DeleteMessages",value:a._0};case 38:return{tag:"RestoreMessageBatch",value:a._0};case 39:return{tag:"OneToOneMessageRequestLoaded",value:a._0};case 40:return{tag:"GroupInviteUpdate",value:a._0};case 41:return{tag:"InitOfflineQueueSyncStart",value:a._0};case 42:return{tag:"InitOfflineQueueSyncComplete",value:a._0};case 43:return{tag:"InitOfflineQueueSyncProgress",value:a._0};case 44:return{tag:"UpdateDyiStatus",value:a._0};case 45:return{tag:"DeleteGroupInvite",value:a._0};case 46:return{tag:"TraceRecordCheckpoint",value:a._0};case 47:return{tag:"DeleteMessageRangesV2",value:a._0};case 48:return{tag:"UpdateMinMessage",value:a._0};case 49:return{tag:"IssuePointQuery",value:a._0};case 50:return{tag:"ThreadBumpedServer",value:a._0};case 51:return{tag:"ParticipantsUpdated",value:a._0};case 52:return{tag:"StartTraceWithTraceId",value:a._0};case 53:return{tag:"UpdateClientRestoreStatus",value:a._0};case 54:return{tag:"NewMsgs",value:{msgs:a._0.msgs.map(d("MAWBridgeTypesWrapper").bridgeMsgToJS)}};case 55:return{tag:"UnArchivedSelfDeviceChangeAlerts",value:a._0};case 56:return{tag:"EphemeralSettingsUpdatedForUI",value:a._0}}}function b(a){switch(a.tag){case"NewMsg":return{_0:d("MAWBridgeTypesWrapper").bridgeMsgToRE(a.value),TAG:0};case"MsgsStartCountdown":return{_0:a.value,TAG:1};case"MsgClearCountdown":return{_0:a.value,TAG:2};case"DropAllSecureThreads":return{_0:a.value,TAG:3};case"VerifyThreadExists":return{_0:a.value,TAG:4};case"MsgUpdated":return{_0:d("MAWBridgeTypesWrapper").bridgeMsgToRE(a.value),TAG:5};case"NewMedia":return{_0:a.value,TAG:6};case"NewMediaRange":return{_0:a.value,TAG:7};case"MediaExpired":return{_0:a.value,TAG:8};case"XMAShareExpired":return{_0:a.value,TAG:9};case"NewXMA":return{_0:a.value,TAG:10};case"XMAShareTombstoned":return{_0:a.value,TAG:11};case"ParticipantUpdated":return{_0:a.value,TAG:12};case"ParticipantRemoved":return{_0:a.value,TAG:13};case"UpdateE2EEMetadataParticipants":return{_0:a.value,TAG:14};case"ReceivedReceipt":return{_0:a.value,TAG:15};case"ThreadUpdated":return{_0:a.value,TAG:16};case"GroupInfoUpdated":return{_0:a.value,TAG:17};case"ThreadBumped":return{_0:a.value,TAG:18};case"ThreadsLoaded":return{_0:a.value,TAG:19};case"ThreadTimestampsUpdated":return{_0:a.value,TAG:20};case"MsgsLoaded":return{_0:a.value,TAG:21};case"InitSyncComplete":return{_0:a.value,TAG:22};case"StartTrace":return{_0:d("MAWBridgeTypesWrapper").bridgeStartTraceDataToRE(a.value),TAG:23};case"UpdateTrace":return{_0:a.value,TAG:24};case"ThreadHidden":return{_0:a.value,TAG:25};case"SyncContacts":return{_0:a.value,TAG:26};case"ReceivedChatState":return{_0:a.value,TAG:27};case"ClockSkewUpdated":return{_0:a.value,TAG:28};case"ABPropsUpdated":return{_0:a.value,TAG:29};case"UpsertReaction":return{_0:a.value,TAG:30};case"DeleteReaction":return{_0:a.value,TAG:31};case"UploadMessage":return{_0:a.value,TAG:32};case"UploadThread":return{_0:a.value,TAG:33};case"CallFinishAddDevice":return{_0:a.value,TAG:34};case"UploadAttachment":return{_0:a.value,TAG:35};case"ResignAttachmentCDNUrl":return{_0:a.value,TAG:36};case"DeleteMessages":return{_0:a.value,TAG:37};case"RestoreMessageBatch":return{_0:a.value,TAG:38};case"OneToOneMessageRequestLoaded":return{_0:a.value,TAG:39};case"GroupInviteUpdate":return{_0:a.value,TAG:40};case"InitOfflineQueueSyncStart":return{_0:a.value,TAG:41};case"InitOfflineQueueSyncComplete":return{_0:a.value,TAG:42};case"InitOfflineQueueSyncProgress":return{_0:a.value,TAG:43};case"UpdateDyiStatus":return{_0:a.value,TAG:44};case"DeleteGroupInvite":return{_0:a.value,TAG:45};case"TraceRecordCheckpoint":return{_0:a.value,TAG:46};case"DeleteMessageRangesV2":return{_0:a.value,TAG:47};case"UpdateMinMessage":return{_0:a.value,TAG:48};case"IssuePointQuery":return{_0:a.value,TAG:49};case"ThreadBumpedServer":return{_0:a.value,TAG:50};case"ParticipantsUpdated":return{_0:a.value,TAG:51};case"StartTraceWithTraceId":return{_0:a.value,TAG:52};case"UpdateClientRestoreStatus":return{_0:a.value,TAG:53};case"NewMsgs":return{_0:{msgs:a.value.msgs.map(d("MAWBridgeTypesWrapper").bridgeMsgToRE)},TAG:54};case"UnArchivedSelfDeviceChangeAlerts":return{_0:a.value,TAG:55};case"EphemeralSettingsUpdatedForUI":return{_0:a.value,TAG:56}}}g.UIEventToJS=a;g.UIEventToRE=b}),98);
__d("MAWBridgeUIEventQPLLogger",["MAWBridgeUIEventsWrapper","QPLUserFlow","Random","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(){return Math.floor(Date.now()+d("Random").random()*1e4+1e4)}function b(a,b){b=d("MAWBridgeUIEventsWrapper").UIEventToJS(b).tag;if(b==="ClockSkewUpdated")return;c("QPLUserFlow").start(c("qpl")._(1056846089,"885"),{annotations:{bool:{dev:0},string:{event:b}},instanceKey:a})}function e(a){c("QPLUserFlow").endSuccess(c("qpl")._(1056846089,"885"),{instanceKey:a})}g.getInstanceKey=a;g.start=b;g.endSuccess=e}),98);
__d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("Promise").resolve()}f.call=a}),66);
__d("MAWUpdateClientRestoreStatusOperationType.bs",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;f.upsertClientRestoreStatus=a;f.removeClientRestoreStatus=b}),66);
__d("MAWBridgeUpdateClientRestoreStatus.bs",["MAWUpdateClientRestoreStatusOperationType.bs","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){return d("ReQL.bs").first(d("ReQL.bs").filter(d("ReQL.bs").fromTableAscending(a.table("encrypted_backups_client_restore_status")),function(a){return a.threadId===c})).then(function(c){if(c!==void 0)return a.table("encrypted_backups_client_restore_status")["delete"]({hd:c.threadId,tl:0}).then(function(a){});else return b("Promise").resolve()})}function a(a){return d("ReQL.bs").toArray(d("ReQL.bs").fromTableAscending(a.table("encrypted_backups_client_restore_status"))).then(function(c){return c.reduce(function(b,c){return b.then(function(b){return h(a,c.threadId)})},b("Promise").resolve())})}function e(a,b){var e=b.action;if(e===d("MAWUpdateClientRestoreStatusOperationType.bs").upsertClientRestoreStatus){e=b.threadId;return a.table("encrypted_backups_client_restore_status").put({lastUpdated:c("bs_caml_int64").of_float(Date.now()),threadId:e})}else return h(a,b.threadId)}g.truncateClientRestoreStatusTable=a;g.call=e}),98);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs",["LS.bs","LSUpdateE2EEMetadataParticipants","MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(e){if(e!==void 0)return c("LSUpdateE2EEMetadataParticipants")(e,d("LS.bs").make(a));else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeUpdateMinMessageHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","ReQLTable.bs","bs_caml_int64","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f=c("bs_caml_int64").of_float(e.minTimestampMs),g=e.minMessageId;return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(h){if(h!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("messages_ranges_v2__generated")),{hd:h,tl:0})).then(function(b){if(b===void 0)return;var i=e.hasMoreBefore,j=i!==void 0?i:b.hasMoreBefore;return d("ReQLTable.bs").update(a.table("messages_ranges_v2__generated"),{hd:h,tl:{hd:b.minTimestampMs,tl:{hd:b.minMessageId,tl:0}}},function(a){if(a!==void 0)return{hasMoreAfter:a.hasMoreAfter,hasMoreBefore:j,isLoadingAfter:a.isLoadingAfter,isLoadingBefore:a.isLoadingBefore,maxMessageId:a.maxMessageId,maxTimestampMs:a.maxTimestampMs,minMessageId:g,minTimestampMs:f,threadKey:a.threadKey};else return c("unrecoverableViolation")("Thread is missing in updating the min message in message range","messenger_e2ee_web")})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeXMAShareExpiredHandler.bs",["MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e=String(c.xmaId);return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.threadId).then(function(d){if(d!==void 0)return a.table("attachments").get({hd:d,tl:{hd:c.msgId,tl:{hd:e,tl:0}}}).then(function(f){if(f===void 0)return b("Promise").resolve();f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(Boolean);f=f.map(function(b){return a.table("attachment_ctas")["delete"]({hd:b,tl:0})});return b("Promise").all(f).then(function(b){return a.table("attachments")["delete"]({hd:d,tl:{hd:c.msgId,tl:{hd:e,tl:0}}})})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeXMAShareTombstonedHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f=String(e.xmaId);return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(g){if(g!==void 0)return a.table("attachments").get({hd:g,tl:{hd:e.msgId,tl:{hd:f,tl:0}}}).then(function(h){if(h===void 0)return b("Promise").resolve();h=[h.defaultCtaId,h.attachmentCta1Id,h.attachmentCta2Id,h.attachmentCta3Id].filter(Boolean);h=h.map(function(b){return a.table("attachment_ctas")["delete"]({hd:b,tl:0})});return b("Promise").all(h).then(function(h){return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("attachments")),{hd:g,tl:{hd:e.msgId,tl:{hd:f,tl:0}}})).then(function(d){if(d!==void 0){d=babelHelpers["extends"]({},d,{previewHeightLarge:void 0,previewWidthLarge:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,subtitleText:void 0,titleText:void 0,previewHeight:void 0,previewWidth:void 0,cta3Type:void 0,cta3Title:void 0,attachmentCta3Id:void 0,cta2Type:void 0,cta2Title:void 0,attachmentCta2Id:void 0,cta1Type:void 0,cta1Title:void 0,attachmentCta1Id:void 0,defaultCtaTitle:void 0,defaultCtaId:void 0});return a.table("attachments").put(d)}c("recoverableViolation")("Trying to tombstone a secure xma attachment but no existing attachment","messenger_e2ee_web");return b("Promise").resolve()})})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeUIEventHandler.bs",["FBLogger","JSResourceForInteraction","MAWBridgeAbPropsUpdatedHandler.bs","MAWBridgeDeleteGroupInviteHandler","MAWBridgeDeleteMessageRangesV2Handler.bs","MAWBridgeDeleteMessagesHandler","MAWBridgeDeleteReactionHandler.bs","MAWBridgeDropAllSecureThreadsHandler.bs","MAWBridgeEphemeralSettingsUpdatedForUIHandler","MAWBridgeGroupInfoUpdatedHandler.bs","MAWBridgeGroupInviteUpdateHandler.bs","MAWBridgeInitOfflineQueueSyncCompleteHandler.bs","MAWBridgeInitOfflineQueueSyncProgressHandler.bs","MAWBridgeInitOfflineQueueSyncStartHandler.bs","MAWBridgeInitSyncCompleteHandler.bs","MAWBridgeMediaExpiredHandler.bs","MAWBridgeMsgClearCountdownHandler.bs","MAWBridgeMsgUpdatedHandler.bs","MAWBridgeMsgsLoadedHandler.bs","MAWBridgeMsgsStartCountdownHandler.bs","MAWBridgeNewMediaHandler.bs","MAWBridgeNewMediaRangeHandler.bs","MAWBridgeNewMsgHandler.bs","MAWBridgeNewXMAHandler.bs","MAWBridgeOneToOneMessageRequestLoadedHandler.bs","MAWBridgeParticipantRemovedHandler.bs","MAWBridgeParticipantUpdatedHandler.bs","MAWBridgeParticipantsUpdatedHandler.bs","MAWBridgeReactionUpsertHandler.bs","MAWBridgeReceivedChatStateHandler.bs","MAWBridgeReceivedReceiptHandler.bs","MAWBridgeSyncContacts.bs","MAWBridgeThreadBumpedHandler.bs","MAWBridgeThreadBumpedServerHandler","MAWBridgeThreadHiddenHandler.bs","MAWBridgeThreadTimestampsHandler.bs","MAWBridgeThreadUpdatedHandler.bs","MAWBridgeThreadsLoadedHandler.bs","MAWBridgeUIEventQPLLogger","MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler","MAWBridgeUpdateClientRestoreStatus.bs","MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs","MAWBridgeUpdateMinMessageHandler.bs","MAWBridgeXMAShareExpiredHandler.bs","MAWBridgeXMAShareTombstonedHandler.bs","MAWDualSendSimplePermissionsManager.bs","MAWGating","Promise","Promise.bs","WATimeUtils","bs_caml_option","bs_curry","bs_js_exn","cr:3910","promiseDone","recoverableViolation","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeIssuePointQueryHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),i=c("requireDeferred")("MAWBridgeStartTraceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),j=c("requireDeferred")("MAWBridgeStartTraceWithTraceIdHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),k=c("requireDeferred")("MAWBridgeTraceRecordCheckpointHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),l=c("requireDeferred")("MAWBridgeUpdateDyiStatus.bs").__setRef("MAWBridgeUIEventHandler.bs"),m=c("requireDeferred")("MAWBridgeUpdateTraceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),n=c("requireDeferred")("MAWBridgeUploadMessageHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),o=c("requireDeferred")("MAWBridgeUploadThreadHandler.bs").__setRef("MAWBridgeUIEventHandler.bs");function a(a,e){a=a.then(function(a){return a.runInTransaction(function(f){var g=d("MAWGating").isArmadillo(),p=d("MAWDualSendSimplePermissionsManager.bs").isDualSendUser(),q=g||p?function(e){switch(e.TAG){case 0:var g=e._0;if(g.isDualSend)return b("Promise").resolve();else return d("MAWBridgeNewMsgHandler.bs").call(a,f,g);case 1:return d("MAWBridgeMsgsStartCountdownHandler.bs").call(f,e._0);case 2:return d("MAWBridgeMsgClearCountdownHandler.bs").call(e._0);case 3:return d("MAWBridgeDropAllSecureThreadsHandler.bs").call(f);case 4:g=e._0;return b("cr:3910").call(f,g);case 5:g=e._0;if(g.isDualSend)return b("Promise").resolve();else return d("MAWBridgeMsgUpdatedHandler.bs").call(a,f,g);case 6:return d("MAWBridgeNewMediaHandler.bs").call(f,e._0);case 7:return d("MAWBridgeNewMediaRangeHandler.bs").call(f,e._0);case 8:return d("MAWBridgeMediaExpiredHandler.bs").call(f,e._0);case 9:return d("MAWBridgeXMAShareExpiredHandler.bs").call(f,e._0);case 10:return d("MAWBridgeNewXMAHandler.bs").call(f,e._0);case 11:return d("MAWBridgeXMAShareTombstonedHandler.bs").call(f,e._0);case 12:return d("MAWBridgeParticipantUpdatedHandler.bs").call(f,e._0);case 13:return d("MAWBridgeParticipantRemovedHandler.bs").call(f,e._0);case 14:return d("MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs").call(f,e._0);case 15:return d("MAWBridgeReceivedReceiptHandler.bs").call(f,e._0);case 16:return d("MAWBridgeThreadUpdatedHandler.bs").call(a,f,e._0);case 17:return d("MAWBridgeGroupInfoUpdatedHandler.bs").call(f,e._0);case 18:return d("MAWBridgeThreadBumpedHandler.bs").call(a,f,e._0);case 19:return d("MAWBridgeThreadsLoadedHandler.bs").call(f,e._0);case 20:return d("MAWBridgeThreadTimestampsHandler.bs").call(f,e._0);case 21:return d("MAWBridgeMsgsLoadedHandler.bs").call(f,e._0);case 22:return d("MAWBridgeInitSyncCompleteHandler.bs").call(f);case 23:var p=e._0;return i.load().then(function(a){return c("bs_curry")._2(a.call,f,p)});case 24:var q=e._0;return m.load().then(function(a){return c("bs_curry")._2(a.call,f,q)});case 25:return d("MAWBridgeThreadHiddenHandler.bs").call(f,e._0);case 26:return d("MAWBridgeSyncContacts.bs").call(f,e._0);case 27:return d("MAWBridgeReceivedChatStateHandler.bs").call(f,e._0);case 28:return window.Promise.resolve((d("WATimeUtils").setClockSkew(e._0),void 0));case 29:return d("MAWBridgeAbPropsUpdatedHandler.bs").call(e._0);case 30:return d("MAWBridgeReactionUpsertHandler.bs").call(f,e._0);case 31:return d("MAWBridgeDeleteReactionHandler.bs").call(f,e._0);case 32:var r=e._0;return n.load().then(function(a){return c("bs_curry")._2(a.call,f,r)});case 33:var s=e._0;return o.load().then(function(a){return c("bs_curry")._2(a.call,f,s)});case 34:var t=e._0;return c("JSResourceForInteraction")("MAWBridgeCallFinishAddDeviceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,t)});case 35:var u=e._0;return c("JSResourceForInteraction")("MAWBridgeUploadAttachmentHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,u)});case 36:var v=e._0;return c("JSResourceForInteraction")("MAWBridgeResignAttachmentCDNUrlHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,v)});case 37:return c("MAWBridgeDeleteMessagesHandler")(f,e._0);case 38:var w=e._0;return c("JSResourceForInteraction")("MAWBridgeRestoreMessageBatchHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,w)});case 39:return d("MAWBridgeOneToOneMessageRequestLoadedHandler.bs").call(f,e._0);case 40:return d("MAWBridgeGroupInviteUpdateHandler.bs").call(f,e._0);case 41:return d("MAWBridgeInitOfflineQueueSyncStartHandler.bs").call(f,e._0);case 42:return d("MAWBridgeInitOfflineQueueSyncCompleteHandler.bs").call(f);case 43:return d("MAWBridgeInitOfflineQueueSyncProgressHandler.bs").call(f,e._0);case 44:var x=e._0;return l.load().then(function(a){return c("bs_curry")._2(a.call,f,x)});case 45:return c("MAWBridgeDeleteGroupInviteHandler")(f,e._0);case 46:var y=e._0;return k.load().then(function(a){return c("bs_curry")._2(a.call,f,y)});case 47:return d("MAWBridgeDeleteMessageRangesV2Handler.bs").call(f,e._0);case 48:return d("MAWBridgeUpdateMinMessageHandler.bs").call(f,e._0);case 49:var z=e._0;return h.load().then(function(a){return c("bs_curry")._2(a.call,f,z)});case 50:return d("MAWBridgeThreadBumpedServerHandler").call(f,e._0);case 51:return d("MAWBridgeParticipantsUpdatedHandler.bs").call(f,e._0);case 52:var A=e._0;return j.load().then(function(a){return c("bs_curry")._2(a.call,f,A)});case 53:return d("MAWBridgeUpdateClientRestoreStatus.bs").call(f,e._0);case 54:return d("MAWBridgeNewMsgHandler.bs").bulkCall(a,f,e._0.msgs);case 55:return d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler").call(f,e._0);case 56:return d("MAWBridgeEphemeralSettingsUpdatedForUIHandler").call(f,e._0)}}:(c("recoverableViolation")("User is neither part of armadillo QE and dual send QE but somehow loaded this handler","messenger_web_product"),function(a){return b("Promise").resolve()});return e.reduce(function(a,b){var e=d("MAWBridgeUIEventQPLLogger").getInstanceKey();return a.then(function(a){d("MAWBridgeUIEventQPLLogger").start(e,b);return c("bs_curry")._1(q,b)}).then(function(a){d("MAWBridgeUIEventQPLLogger").endSuccess(e);return a})},b("Promise").resolve())},"readwrite")});c("promiseDone")(a,void 0,function(a){a=a.RE_EXN_ID===d("Promise.bs").JsError||a.RE_EXN_ID===c("bs_js_exn").$$Error?c("bs_caml_option").some(a._1):a;c("FBLogger")("messenger_e2ee_web").catching(a).warn("Error handling UI Event")})}g.$MAWBridgeIssuePointQueryHandler$Deferred=h;g.$MAWBridgeStartTraceHandler$Deferred=i;g.$MAWBridgeStartTraceWithTraceIdHandler$Deferred=j;g.$MAWBridgeTraceRecordCheckpointHandler$Deferred=k;g.$MAWBridgeUpdateDyiStatus$Deferred=l;g.$MAWBridgeUpdateTraceHandler$Deferred=m;g.$MAWBridgeUploadMessageHandler$Deferred=n;g.$MAWBridgeUploadThreadHandler$Deferred=o;g.MAWVerifyThreadExistsHandler=b("cr:3910");g.handleEvents=a}),98);
__d("MAWBridgeUIEventHandler.re",["MAWBridgeUIEventHandler.bs"],(function(a,b,c,d,e,f){a=b("MAWBridgeUIEventHandler.bs").handleEvents;f.handleEvents=a}),null);
__d("MAWBridgeOccamadilloVerifyThreadExistsHandler.bs",["LS.bs","LSAuthorityLevel.bs","LSCoreClientFolderType.bs","LSCreateE2EEMetadataThread","LSCreateOfflineThreadingID","MAWFolder.bs","MAWJidUtils.bs","MAWJids","MAWThreadDefaults.bs","MAWTimeUtils","MessagingThreadType.bs","Promise","ReQL.bs","ReQLTable.bs","WALogger.bs","WATimeUtils","bs_caml","bs_caml_format","bs_caml_int64","bs_int64","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return c("bs_caml_format").caml_int64_of_string(d("MAWJidUtils.bs").switchOnChatJidType(a,{group:d("MAWJids").groupIdFromJid,user:d("MAWJids").userIdFromJid}))}function i(a,b,e){return d("ReQLTable.bs").update(a.table("threads"),{hd:e,tl:0},function(a){if(a===void 0)return c("unrecoverableViolation")("Thread is missing in occamadillo verify thread exists","messenger_e2ee_web");var f=c("bs_caml").i64_eq(a.lastActivityTimestampMs,c("bs_caml_int64").zero)?(d("WALogger.bs").warn("[Occamadillo] Detected 0 for last activity timestamp from MI for thread: "+c("bs_int64").to_string(e)+", using local state timestamp: "+c("bs_int64").to_string(d("MAWTimeUtils").millisTimeToTimestamp(b.lastActivityTs))),d("MAWTimeUtils").millisTimeToTimestamp(b.lastActivityTs)):a.lastActivityTimestampMs,g=b.clientThreadKey;return babelHelpers["extends"]({},a,{capabilities2:d("MAWThreadDefaults.bs").defaultThreadCapabilities_2,capabilities:b.isGroup?d("MAWThreadDefaults.bs").defaultGroupThreadCapabilities:d("MAWThreadDefaults.bs").defaultThreadCapabilities,clientThreadKey:g==null?a.clientThreadKey:c("bs_caml_format").caml_int64_of_string(g),lastReadWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(b.lastReadTs),lastActivityTimestampMs:f,threadKey:e})}).then(function(a){})}function j(a,d,e){d=d.clientThreadKey;if(d==null)return b("Promise").resolve();d=c("bs_caml_format").caml_int64_of_string(d);if(c("bs_int64").equal(d,e))return b("Promise").resolve();else return a.table("threads")["delete"]({hd:d,tl:0})}function k(a,d,e){return a.table("mi_act_mapping_table").put({clientThreadPk:c("bs_caml_int64").of_int32(e.chatId),jid:h(e.jid),serverThreadKey:d}).then(function(c){return b("Promise").all([i(a,e,d),j(a,e,d)]).then(function(a){})})}function a(a,e){var f=e.chatId;return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromIndexAscending(a.table("mi_act_mapping_table").index("chat_id")),{hd:c("bs_caml_int64").of_int32(f),tl:0})).then(function(g){var l=f.toString(),m=e.authoritativeThreadKey;if(g===void 0)if(m==null){d("WALogger.bs").log("[Occamadillo] 1. Optimistic thread or backfill thread, we need to upgrade to authoritative thread for chatId: "+l);var n=d("MAWFolder.bs").systemFolderToLSCoreClientFolder(e.folder);if(e.isDualSend)return b("Promise").resolve();var o;if(n!==void 0)o=n;else{n="[Occamadillo] no folder type was supplied to Occamadillo verify thread exists handler";d("WALogger.bs").error(n);d("WALogger.bs").warn(n+" for chatId: "+e.chatId.toString());o=d("LSCoreClientFolderType.bs").inbox}var p=d("LS.bs").make(a);n=e.clientThreadKey;n=n==null?c("LSCreateOfflineThreadingID")(c("bs_caml_int64").of_float(Date.now()),p).then(function(a){return a[0]}):b("Promise").resolve(c("bs_caml_format").caml_int64_of_string(n));return n.then(function(b){var f=h(e.jid),g=d("MAWTimeUtils").millisTimeToTimestamp(e.lastActivityTs),i=c("bs_int64").equal(g,c("bs_caml_int64").zero)?d("MAWTimeUtils").millisTimeToTimestamp(d("WATimeUtils").millisTime()):g,j=e.isGroup?d("MessagingThreadType.bs").secureMessageOverWaGroup:d("MessagingThreadType.bs").secureMessageOverWaOneToOne;return a.table("mi_act_mapping_table").put({clientThreadPk:c("bs_caml_int64").of_int32(e.chatId),jid:f,serverThreadKey:b}).then(function(a){d("WALogger.bs").log("[Occamadillo] Creating e2ee metadata optimistic thread key: "+c("bs_int64").to_string(b)+" bumpTimestampMs: "+c("bs_int64").to_string(i));return c("LSCreateE2EEMetadataThread")(f,b,j,o,i,p)})})}else{d("WALogger.bs").log("[Occamadillo] 2. Authoritative thread, we don't have it in miActMapping table yet for chatId: "+l);return k(a,c("bs_caml_format").caml_int64_of_string(m),e)}if(!(m==null)&&g.serverThreadKey!==c("bs_caml_format").caml_int64_of_string(m)){d("WALogger.bs").log("[Occamadillo] 3. Authoritative thread, we have it in the mapping but it still has the optimistic thread key for chatId: "+l);return k(a,c("bs_caml_format").caml_int64_of_string(m),e)}d("WALogger.bs").log("[Occamadillo] 4. Authoritative thread, we have it in the miActMapping table already for chatId: "+l);return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:g.serverThreadKey,tl:0})).then(function(f){if(f!==void 0&&c("bs_caml").i64_eq(f.authorityLevel,d("LSAuthorityLevel.bs").authoritative))return b("Promise").all([i(a,e,g.serverThreadKey),j(a,e,g.serverThreadKey)]).then(function(a){});else return b("Promise").resolve()})})}g.call=a}),98);
__d("MAWOccamadilloOnMutexChange",["LSDatabaseType.bs","LSDefaultSyncGroups","LSIntEnum","LSSyncGroupsUtils","MAWGating","Promise","WALogger","bs_caml_int64","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Resetting sync cursor and network request"]);h=function(){return a};return a}function i(a){var c=d("LSDefaultSyncGroups").e2eeMetadataSyncGroup;if(d("MAWGating").isOccamadillo()&&!d("MAWGating").isOccamadilloResumeSyncEnabled()&&c!=null)return a.table("sync_groups").put(babelHelpers["extends"]({},d("LSSyncGroupsUtils").defaultSyncGroup,{groupId:d("LSIntEnum").ofNumber(c.groupId)}));else return b("Promise").resolve()}function j(a){if(d("MAWGating").isOccamadillo()&&!d("MAWGating").isOccamadilloResumeSyncEnabled())return a.table("network_requests").put({epochId:void 0,failureCount:c("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c("bs_caml_int64").zero,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:d("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,taskQueueName:""});else return b("Promise").resolve()}function a(a){d("WALogger").LOG(h()),c("promiseDone")(a.runInTransaction(function(a){return b("Promise").all([i(a),j(a)])},"readwrite"))}g.onOccamadilloMutexChange=a}),98);
__d("MAWCommonSetupUser",["CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(){return{getAccountID:c("CurrentUser").getAccountID(),getAppID:c("CurrentUser").getAppID(),getEIMU:c("CurrentUser").getEIMU(),getEmployeeWorkUserID:c("CurrentUser").getEmployeeWorkUserID(),getID:c("CurrentUser").getID(),getName:c("CurrentUser").getName(),getPossiblyNonFacebookUserID:c("CurrentUser").getPossiblyNonFacebookUserID(),getShortName:c("CurrentUser").getShortName(),hasSecondaryBusinessPerson:c("CurrentUser").hasSecondaryBusinessPerson(),hasWorkUser:c("CurrentUser").hasWorkUser(),isBusinessPersonAccount:c("CurrentUser").isBusinessPersonAccount(),isDeactivatedAllowedOnMessenger:c("CurrentUser").isDeactivatedAllowedOnMessenger(),isEmployee:c("CurrentUser").isEmployee(),isFacebookWorkAccount:c("CurrentUser").isFacebookWorkAccount(),isGray:c("CurrentUser").isGray(),isLoggedIn:c("CurrentUser").isLoggedIn(),isLoggedInNow:c("CurrentUser").isLoggedInNow(),isMessengerCallGuestUser:c("CurrentUser").isMessengerCallGuestUser(),isMessengerOnlyUser:c("CurrentUser").isMessengerOnlyUser(),isTestUser:c("CurrentUser").isTestUser(),isUnderage:c("CurrentUser").isUnderage(),isWorkroomsUser:c("CurrentUser").isWorkroomsUser(),isWorkUser:c("CurrentUser").isWorkUser()}}g.getCurrentUserForArmadilloSetup_DO_NOT_USE=a}),98);
__d("LSMessagingThreadAttributionType.re",["LSMessagingThreadAttributionType.bs"],(function(a,b,c,d,e,f){c=(a=b("LSMessagingThreadAttributionType.bs")).unknown;f.unknown=c;d=a.unknownTest;f.unknownTest=d;e=a.unknownFailureRetry;f.unknownFailureRetry=e;b=a.messengerInbox;f.messengerInbox=b;c=a.messengerInboxInThread;f.messengerInboxInThread=c;d=a.messengerInboxThreadList;f.messengerInboxThreadList=d;e=a.messengerInboxNestedFolder;f.messengerInboxNestedFolder=e;b=a.messengerInboxRecentThreads;f.messengerInboxRecentThreads=b;c=a.messengerInboxRemainingThreads;f.messengerInboxRemainingThreads=c;d=a.messengerInboxMessageSearch;f.messengerInboxMessageSearch=d;e=a.messengerInboxImageSending;f.messengerInboxImageSending=e;b=a.messengerInboxForward;f.messengerInboxForward=b;c=a.messengerInboxArchivedThreads;f.messengerInboxArchivedThreads=c;d=a.messengerInboxPendingRequests;f.messengerInboxPendingRequests=d;e=a.messengerInboxActiveContacts;f.messengerInboxActiveContacts=e;b=a.messengerUniversalSearch;f.messengerUniversalSearch=b;c=a.messengerUniversalSearchNullState;f.messengerUniversalSearchNullState=c;d=a.messengerUniversalSearchKeyPressed;f.messengerUniversalSearchKeyPressed=d;e=a.messengerUniversalSearchMessageSearch;f.messengerUniversalSearchMessageSearch=e;b=a.messengerUniversalSearchAdvancedContentSearch;f.messengerUniversalSearchAdvancedContentSearch=b;c=a.montageAndActiveNow;f.montageAndActiveNow=c;d=a.montageAndActiveNowMontageInboxUnit;f.montageAndActiveNowMontageInboxUnit=d;e=a.montageAndActiveNowActiveNow;f.montageAndActiveNowActiveNow=e;b=a.montageAndActiveNowInboxComposer;f.montageAndActiveNowInboxComposer=b;c=a.montageAndActiveNowActiveAndHasStory;f.montageAndActiveNowActiveAndHasStory=c;d=a.messengerActiveNowFriendsTab;f.messengerActiveNowFriendsTab=d;e=a.messengerActiveNowFriendsTabFriendsTab;f.messengerActiveNowFriendsTabFriendsTab=e;b=a.messengerActiveNowFriendsTabPlaceHolder;f.messengerActiveNowFriendsTabPlaceHolder=b;c=a.messengerActiveNowFriendsTabRecentActive;f.messengerActiveNowFriendsTabRecentActive=c;d=a.messengerActiveNowFriendsTabRecentActiveAndStory;f.messengerActiveNowFriendsTabRecentActiveAndStory=d;e=a.messengerActiveNowFriendsTabContentDiscovery;f.messengerActiveNowFriendsTabContentDiscovery=e;b=a.messengerPendingRequests;f.messengerPendingRequests=b;c=a.messengerPendingRequestsInboxThreadList;f.messengerPendingRequestsInboxThreadList=c;d=a.messengerPendingRequestsPendingRequestsPage;f.messengerPendingRequestsPendingRequestsPage=d;e=a.messengerBroadcastFlow;f.messengerBroadcastFlow=e;b=a.messengerBroadcastFlowFromMessenger;f.messengerBroadcastFlowFromMessenger=b;c=a.messengerBroadcastFlowFromFb;f.messengerBroadcastFlowFromFb=c;d=a.messengerBroadcastFlowFromExternal;f.messengerBroadcastFlowFromExternal=d;e=a.messengerBroadcastFlowFromFbNewsfeedSharesheet;f.messengerBroadcastFlowFromFbNewsfeedSharesheet=e;b=a.messengerBroadcastFlowFromFbNewsfeedGoodwillComposer;f.messengerBroadcastFlowFromFbNewsfeedGoodwillComposer=b;c=a.messengerBroadcastFlowFromFbShortsViewer;f.messengerBroadcastFlowFromFbShortsViewer=c;d=a.messengerBroadcastFlowForwardGutter;f.messengerBroadcastFlowForwardGutter=d;e=a.messengerBroadcastFlowForwardLongclick;f.messengerBroadcastFlowForwardLongclick=e;b=a.messengerBroadcastFlowMessengerPhotoView;f.messengerBroadcastFlowMessengerPhotoView=b;c=a.messengerOmnipicker;f.messengerOmnipicker=c;d=a.messengerOmnipickerNullState;f.messengerOmnipickerNullState=d;e=a.messengerOmnipickerKeyPressed;f.messengerOmnipickerKeyPressed=e;b=a.messengerNotification;f.messengerNotification=b;c=a.messengerNotificationInThreadReply;f.messengerNotificationInThreadReply=c;d=a.messengerNotificationLongpressReply;f.messengerNotificationLongpressReply=d;e=a.messengerNotificationLongpressReaction;f.messengerNotificationLongpressReaction=e;b=a.clickToMessengerAd;f.clickToMessengerAd=b;c=a.clickToMessengerAdFromNewsfeed;f.clickToMessengerAdFromNewsfeed=c;d=a.clickToMessengerAdSendMessageCta;f.clickToMessengerAdSendMessageCta=d;e=a.clickToMessengerAdViewAndMessage;f.clickToMessengerAdViewAndMessage=e;b=a.clickToMessengerAdSendMessageCtaNewsfeedCtmAdsCta;f.clickToMessengerAdSendMessageCtaNewsfeedCtmAdsCta=b;c=a.payments;f.payments=c;d=a.paymentsBubbleClick;f.paymentsBubbleClick=d;e=a.rtc;f.rtc=e;b=a.rtcVoipIncall;f.rtcVoipIncall=b;c=a.fbPage;f.fbPage=c;d=a.fbPageAboutCard;f.fbPageAboutCard=d;e=a.fbPageProfileHeaderMessageButton;f.fbPageProfileHeaderMessageButton=e;b=a.fbPageProfileFooterMessageButton;f.fbPageProfileFooterMessageButton=b;c=a.fbPageProfileMoreDrawer;f.fbPageProfileMoreDrawer=c;d=a.fbPageResponsivenessContextCard;f.fbPageResponsivenessContextCard=d;e=a.fbPagePymmRhc;f.fbPagePymmRhc=e;b=a.fbProfile;f.fbProfile=b;c=a.fbProfileTimelineMessageButton;f.fbProfileTimelineMessageButton=c;d=a.fbProfileFacebookProfile;f.fbProfileFacebookProfile=d;e=a.fbProfileMessageButton;f.fbProfileMessageButton=e;b=a.fbSearch;f.fbSearch=b;c=a.fbSearchContextualProfileActionBarFromSearch;f.fbSearchContextualProfileActionBarFromSearch=c;d=a.fbSearchSearchMessageButton;f.fbSearchSearchMessageButton=d;e=a.fbSearchFbMessageSearchResults;f.fbSearchFbMessageSearchResults=e;b=a.fbSearchHighConfidenceCard;f.fbSearchHighConfidenceCard=b;c=a.fbSearchMentions;f.fbSearchMentions=c;d=a.fbSearchNullstateCta;f.fbSearchNullstateCta=d;e=a.crypto;f.crypto=e;b=a.messengerMontageComposer;f.messengerMontageComposer=b;c=a.messengerMontageComposerFriendsTab;f.messengerMontageComposerFriendsTab=c;d=a.messengerMontageComposerFriendsTabStoryAndActiveNow;f.messengerMontageComposerFriendsTabStoryAndActiveNow=d;e=a.messengerMontageReply;f.messengerMontageReply=e;b=a.messengerMontageReplyInboxThreadListProfile;f.messengerMontageReplyInboxThreadListProfile=b;c=a.messengerMontageReplyReplyContext;f.messengerMontageReplyReplyContext=c;d=a.messengerMontageReplyThreadNavBar;f.messengerMontageReplyThreadNavBar=d;e=a.messengerMontageReplyInboxThreadListProfileAuthorProfile;f.messengerMontageReplyInboxThreadListProfileAuthorProfile=e;b=a.messengerMontageReplyReplyContextAuthorProfile;f.messengerMontageReplyReplyContextAuthorProfile=b;c=a.messengerMontageReplyThreadNavBarAuthorProfile;f.messengerMontageReplyThreadNavBarAuthorProfile=c;d=a.messengerMontageReplyOneToOneChatThreadStoryBubble;f.messengerMontageReplyOneToOneChatThreadStoryBubble=d;e=a.messengerThreadMembersList;f.messengerThreadMembersList=e;b=a.marketplace;f.marketplace=b;c=a.marketplaceActivityBanner;f.marketplaceActivityBanner=c;d=a.marketplaceSendMessage;f.marketplaceSendMessage=d;e=a.fbStory;f.fbStory=e;b=a.fbStoryViewerSheetMenu;f.fbStoryViewerSheetMenu=b;c=a.fbStoryViewerSheetRow;f.fbStoryViewerSheetRow=c;d=a.fbStoryStoriesJewelNotification;f.fbStoryStoriesJewelNotification=d;e=a.fbStoryStoriesPushNotification;f.fbStoryStoriesPushNotification=e;b=a.fbStoryStoriesViewerConsumerReply;f.fbStoryStoriesViewerConsumerReply=b;c=a.fbStoryStoriesViewerConsumerArtifact;f.fbStoryStoriesViewerConsumerArtifact=c;d=a.fbStoryStoriesPageStoryConversations;f.fbStoryStoriesPageStoryConversations=d;e=a.fbStorySocialContextConversations;f.fbStorySocialContextConversations=e;b=a.workspeed;f.workspeed=b;c=a.workspeedComposerLikeButton;f.workspeedComposerLikeButton=c;d=a.workspeedComposerGifPicker;f.workspeedComposerGifPicker=d;e=a.mdotme;f.mdotme=e;b=a.mdotmeOrganicPost;f.mdotmeOrganicPost=b;c=a.mdotmeMarketingEmail;f.mdotmeMarketingEmail=c;d=a.mdotmeMbsOffsiteEmail;f.mdotmeMbsOffsiteEmail=d;e=a.customerChatPlugin;f.customerChatPlugin=e;b=a.customerChatPluginMobileRedirect;f.customerChatPluginMobileRedirect=b;c=a.customerChatPluginUpgradeFlow;f.customerChatPluginUpgradeFlow=c;d=a.customerChatPluginReEngagement;f.customerChatPluginReEngagement=d;e=a.fbFeed;f.fbFeed=e;b=a.fbFeedOrganicPost;f.fbFeedOrganicPost=b;c=a.fbFeedOrganicPostViewAndMessage;f.fbFeedOrganicPostViewAndMessage=c;d=a.fbFeedQuestionTriggeredConvo;f.fbFeedQuestionTriggeredConvo=d;e=a.fbFeedDynamicHoverCard;f.fbFeedDynamicHoverCard=e;b=a.fbFeedOrganicPostNewsfeedPagePostCta;f.fbFeedOrganicPostNewsfeedPagePostCta=b;c=a.fbFeedOrganicPostNewsfeedBumperSmcta;f.fbFeedOrganicPostNewsfeedBumperSmcta=c;d=a.fbFeedBcfOpenChatButton;f.fbFeedBcfOpenChatButton=d;e=a.fbFeedReactorsListMessageButton;f.fbFeedReactorsListMessageButton=e;b=a.fbFeedReplyToAuthor;f.fbFeedReplyToAuthor=b;c=a.fbFeedUfiSendSuggestions;f.fbFeedUfiSendSuggestions=c;d=a.fbFeedBcf;f.fbFeedBcf=d;e=a.fbNotification;f.fbNotification=e;b=a.fbNotificationJewelNotif;f.fbNotificationJewelNotif=b;c=a.fbNotificationPushNotif;f.fbNotificationPushNotif=c;d=a.fbEvent;f.fbEvent=d;e=a.fbEventMessageHost;f.fbEventMessageHost=e;b=a.fbEventShareClassMaterials;f.fbEventShareClassMaterials=b;c=a.supportResources;f.supportResources=c;d=a.supportResourcesFrxAction;f.supportResourcesFrxAction=d;e=a.leadGenMessaging;f.leadGenMessaging=e;b=a.leadGenMessagingPreSubmission;f.leadGenMessagingPreSubmission=b;c=a.leadGenMessagingPostSubmission;f.leadGenMessagingPostSubmission=c;d=a.leadGenMessagingCrossChannelVerticalPresentAndroid;f.leadGenMessagingCrossChannelVerticalPresentAndroid=d;e=a.leadGenMessagingCrossChannelHscrollAndroid;f.leadGenMessagingCrossChannelHscrollAndroid=e;b=a.messengerGraph;f.messengerGraph=b;c=a.messengerGraphSelectContact;f.messengerGraphSelectContact=c;d=a.messengerChat;f.messengerChat=d;e=a.messengerChatFromJewelThreadList;f.messengerChatFromJewelThreadList=e;b=a.messengerChatInThread;f.messengerChatInThread=b;c=a.messengerChatForward;f.messengerChatForward=c;d=a.messengerArchivedThreads;f.messengerArchivedThreads=d;e=a.messengerArchivedThreadsArchivedThreadsFolder;f.messengerArchivedThreadsArchivedThreadsFolder=e;b=a.jewel;f.jewel=b;c=a.jewelThreadList;f.jewelThreadList=c;d=a.jewelSearch;f.jewelSearch=d;e=a.jewelNewMessage;f.jewelNewMessage=e;b=a.jewelNestedFolder;f.jewelNestedFolder=b;c=a.chatheads;f.chatheads=c;d=a.chatheadsRecentThreads;f.chatheadsRecentThreads=d;e=a.chatheadsOverflow;f.chatheadsOverflow=e;b=a.chatheadsNewMessage;f.chatheadsNewMessage=b;c=a.sidebar;f.sidebar=c;d=a.sidebarContactsList;f.sidebarContactsList=d;e=a.sidebarContactsSearch;f.sidebarContactsSearch=e;b=a.sidebarContactsGroups;f.sidebarContactsGroups=b;c=a.messengerCommunityMessaging;f.messengerCommunityMessaging=c;d=a.messengerCommunityMessagingCommunityChannel;f.messengerCommunityMessagingCommunityChannel=d;e=a.messengerCommunityMessagingFullscreenChat;f.messengerCommunityMessagingFullscreenChat=e;b=a.fbPlatformLogin;f.fbPlatformLogin=b;c=a.fbPlatformLoginLoginConnectWithMessenger;f.fbPlatformLoginLoginConnectWithMessenger=c;d=a.contactManager;f.contactManager=d;e=a.contactManagerContactShare;f.contactManagerContactShare=e;b=a.contactManagerPeopleTabContactList;f.contactManagerPeopleTabContactList=b;c=a.contactManagerPeopleTabContactSearch;f.contactManagerPeopleTabContactSearch=c;d=a.contactManagerIconContactList;f.contactManagerIconContactList=d;e=a.contactManagerIconContactSearch;f.contactManagerIconContactSearch=e;b=a.messagingInboxInBlue;f.messagingInboxInBlue=b;c=a.messagingInboxInBlueThreadList;f.messagingInboxInBlueThreadList=c;d=a.messagingInboxInBluePeoplePicker;f.messagingInboxInBluePeoplePicker=d;e=a.messagingInboxInBlueInboxIcon;f.messagingInboxInBlueInboxIcon=e;b=a.messagingInboxInBlueSwipeFromRight;f.messagingInboxInBlueSwipeFromRight=b;c=a.messagingInboxInBlueMibNotification;f.messagingInboxInBlueMibNotification=c;d=a.messagingInboxInBlueActiveNow;f.messagingInboxInBlueActiveNow=d;e=a.messagingInboxInBlueSuggestedChats;f.messagingInboxInBlueSuggestedChats=e;b=a.messagingInboxInBlueChatPreviewBanner;f.messagingInboxInBlueChatPreviewBanner=b;c=a.messagingInboxInBlueThreadViewCoreNullState;f.messagingInboxInBlueThreadViewCoreNullState=c;d=a.messagingInboxInBlueMessageRequests;f.messagingInboxInBlueMessageRequests=d;e=a.messagingInboxInBlueSpam;f.messagingInboxInBlueSpam=e;b=a.messagingInboxInBlueFbGroups;f.messagingInboxInBlueFbGroups=b;c=a.messagingInboxInBlueMessengerPeekStateButton;f.messagingInboxInBlueMessengerPeekStateButton=c;d=a.messagingInboxInBlueMessengerPeekStateTooltip;f.messagingInboxInBlueMessengerPeekStateTooltip=d;e=a.messagingInboxInBlueBroadcastFlow;f.messagingInboxInBlueBroadcastFlow=e;b=a.messagingInboxInBlueThreadViewHeader;f.messagingInboxInBlueThreadViewHeader=b;c=a.messagingInboxInBluePrivacySettings;f.messagingInboxInBluePrivacySettings=c;d=a.messagingInboxInBlueArchivedChats;f.messagingInboxInBlueArchivedChats=d;e=a.mibNotification;f.mibNotification=e;b=a.mibNotificationPushNotification;f.mibNotificationPushNotification=b;c=a.mibNotificationJewelNotification;f.mibNotificationJewelNotification=c;d=a.mibNotificationDirectPushNotif;f.mibNotificationDirectPushNotif=d;e=a.mibNotificationDirectJewelNotif;f.mibNotificationDirectJewelNotif=e;b=a.messengerRestrictedAccounts;f.messengerRestrictedAccounts=b;c=a.armadilloCutoverThreadLinkingMessage;f.armadilloCutoverThreadLinkingMessage=c;d=a.callsTab;f.callsTab=d;e=a.miniShopViewMenuButton;f.miniShopViewMenuButton=e;b=a.sharesheet;f.sharesheet=b;c=a.sharesheetGeneralizedBroadcastFlow;f.sharesheetGeneralizedBroadcastFlow=c;d=a.sharesheetOffPlatformSharingHScroll;f.sharesheetOffPlatformSharingHScroll=d;e=a.ufi;f.ufi=e;b=a.ufiGeneralizedBroadcastFlow;f.ufiGeneralizedBroadcastFlow=b;c=a.chatheadClickCollapsed;f.chatheadClickCollapsed=c;d=a.timelineMessageButton;f.timelineMessageButton=d;e=a.directReplyIntent;f.directReplyIntent=e;b=a.fbGroups;f.fbGroups=b;c=a.fbGroupsInbox;f.fbGroupsInbox=c;d=a.fbGroupsPickerExistingChat;f.fbGroupsPickerExistingChat=d;e=a.fbGroupsPickerJoinChat;f.fbGroupsPickerJoinChat=e;b=a.fbGroupsMemberList;f.fbGroupsMemberList=b;c=a.devices;f.devices=c;d=a.devicesStella;f.devicesStella=d;e=a.fbWellbeing;f.fbWellbeing=e;b=a.fbWellbeingIncallUnblockingNotification;f.fbWellbeingIncallUnblockingNotification=b;c=a.messengerDeepLinking;f.messengerDeepLinking=c;d=a.readOnlyCutoverThread;f.readOnlyCutoverThread=d;e=a.readOnlyCutoverThreadArmadilloThread;f.readOnlyCutoverThreadArmadilloThread=e;b=a.armadilloThread;f.armadilloThread=b;c=a.armadilloThreadReadOnlyCutoverThread;f.armadilloThreadReadOnlyCutoverThread=c;d=a.armadilloThreadExternalLink;f.armadilloThreadExternalLink=d;e=a.fbShorts;f.fbShorts=e;b=a.fbShortsProfile;f.fbShortsProfile=b;c=a.fbShortsReactorsListMessageButton;f.fbShortsReactorsListMessageButton=c;d=a.sendPlugin;f.sendPlugin=d;e=a.sendAsMessageFromNt;f.sendAsMessageFromNt=e;b=a.messengerPublicChatsMessaging;f.messengerPublicChatsMessaging=b;c=a.messengerGrowth;f.messengerGrowth=c;d=a.messengerGrowthNotificationsEntrypoint;f.messengerGrowthNotificationsEntrypoint=d;e=a.friendsHome;f.friendsHome=e;b=a.friendsHomeActiveNow;f.friendsHomeActiveNow=b;c=a.friendsHomeMessageNewFriends;f.friendsHomeMessageNewFriends=c;d=a.friendsHomePostAcceptMessaging;f.friendsHomePostAcceptMessaging=d;e=a.externalLinkXma;f.externalLinkXma=e;b=a.externalLinkXmaFromComposer;f.externalLinkXmaFromComposer=b;c=a.externalLinkXmaFromDeepLinking;f.externalLinkXmaFromDeepLinking=c;d=a.externalLinkXmaFromShareExtension;f.externalLinkXmaFromShareExtension=d;e=a.fbNotifications;f.fbNotifications=e}),null);
__d("MAWDBUsageMetrics",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=30*1e3,i=0,j=null;function a(){if(Date.now()>i+h){var a=navigator.storage;a==null?void 0:a.estimate==null?void 0:a.estimate().then(function(a){j=a});i=Date.now()}return j}c("gkx")("5444")&&a();g.getMAWDBUsageMetrics=a}),98);
__d("MessagingBackend.re",["MessagingBackend.bs"],(function(a,b,c,d,e,f){a=b("MessagingBackend.bs").messengerInfra;f.messengerInfra=a;c=b("MessagingBackend.bs").whatsappInfra;f.whatsappInfra=c}),null);
__d("MessagingLoggingUtilsAttachmentTypeInt.re",["MessagingLoggingUtilsAttachmentTypeInt.bs"],(function(a,b,c,d,e,f){c=(a=b("MessagingLoggingUtilsAttachmentTypeInt.bs")).text;f.text=c;d=a.none;f.none=d;e=a.fbVoiceMessage;f.fbVoiceMessage=e;b=a.like;f.like=b;c=a.sticker;f.sticker=c;d=a.videoMessage;f.videoMessage=d;e=a.gif;f.gif=e;b=a.location;f.location=b;c=a.image;f.image=c;d=a.application;f.application=d;e=a.video;f.video=e;b=a.audio;f.audio=b;c=a.messengerInvite;f.messengerInvite=c;d=a.share;f.share=d;e=a.liveLocation;f.liveLocation=e;b=a.lightweightAction;f.lightweightAction=b;c=a.fakeNewsLink;f.fakeNewsLink=c;d=a.p2pPayment;f.p2pPayment=d;e=a.montageDirect;f.montageDirect=e;b=a.sphericalPhoto;f.sphericalPhoto=b;c=a.reaction;f.reaction=c;d=a.story;f.story=d;e=a.selfieSticker;f.selfieSticker=e;b=a.soundBite;f.soundBite=b;c=a.armadilloSysPacket;f.armadilloSysPacket=c;d=a.deleteForMe;f.deleteForMe=d;e=a.unsend;f.unsend=e;b=a.unsendReaction;f.unsendReaction=b;c=a.poll;f.poll=c;d=a.avatarLike;f.avatarLike=d;e=a.stack;f.stack=e;b=a.igBcCollaboratorInviteXma;f.igBcCollaboratorInviteXma=b}),null);
__d("SendEventType.re",["SendEventType.bs"],(function(a,b,c,d,e,f){c=(a=b("SendEventType.bs")).sendAttempt;f.sendAttempt=c;d=a.sendAcknowledgement;f.sendAcknowledgement=d;e=a.appdataAttempt;f.appdataAttempt=e;b=a.appdataAcknowledgement;f.appdataAcknowledgement=b;c=a.uiSendClick;f.uiSendClick=c}),null);
__d("WAShiftTimer",["WAErr"],(function(a,b,c,d,e,f,g){a=function(){function a(a){var b=this;this.$2=0;this.$3=0;this.ts=0;this.$4=0;this.$5=0;this.$6=0;this.$7=void 0;this.$8=function(){var a=b.$7,c=b.$1;b.$3=0;b.$2=0;b.ts=0;b.$4=0;b.$5=0;b.$6=0;b.$7=void 0;c(a)};this.onOrBefore=function(a,c){h(a);var d=Date.now();d=d+a;var e=b.$5;if(e!==0&&e<d)return;e=b.$6;if(e!==0&&d<e)return;b.$5=d;!b.$3&&(!b.$2||d<b.ts)&&b.$9(d,a,c)};this.forceRunNow=function(a){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$7=a,b.$8()};this.cancel=function(){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$2=0,b.$3=0,b.ts=0,b.$4=0,b.$5=0,b.$6=0,b.$7=void 0};this.$1=a}var b=a.prototype;b.onOrBeforeRepaint=function(a){if(this.$3)return;var b=Date.now(),c=this.$6;if(c!==0&&b<c)return;c=this.$5;(c===0||b<c)&&(this.$5=b);this.$2&&(clearTimeout(this.$2),this.$2=0);(!this.ts||this.ts>b)&&(this.ts=b);this.$7=a;this.$3=requestAnimationFrame(this.$8)};b.onOrAfter=function(a,b){h(a);var c=Date.now();c=c+a;var d=this.$6;if(d!==0&&c<d)return;d=this.$5;if(d!==0&&d<c)return;this.$6=c;(!this.$2||this.ts<c)&&this.$9(c,a,b)};b.debounce=function(a,b){h(a),this.$10(Date.now(),a,b)};b.debounceAndCap=function(a,b,c){h(a);h(b);var d=Date.now();b=d+b;var e=this.$6,f=this.$5;(e===0||e<=b)&&(f===0||b<f)&&(this.$5=b);this.$10(d,a,c)};b.forceRunNowIfScheduled=function(){this.$2?(clearTimeout(this.$2),this.$8()):this.$3&&(cancelAnimationFrame(this.$3),this.$8())};b.isScheduled=function(){return this.$2!==0||this.$3!==0};b.$10=function(a,b,c){var d=a+b,e=this.$6;if(e!==0&&d<e)return;e=this.ts;var f=this.$5;f!==0&&f<d?e<f&&this.$9(f,f-a,c):e<d&&this.$9(d,b,c)};b.$9=function(a,b,c){this.$3&&(cancelAnimationFrame(this.$3),this.$3=0);this.$7=c;this.ts=a;if(this.$2){c=a-this.$4;if(-16<c&&c<16)return;clearTimeout(this.$2)}this.$2=setTimeout(this.$8,b);this.$4=a};return a}();function h(a){if(!(a>=0))throw c("WAErr")("ShiftTimer must be given delay >= 0")}g.ShiftTimer=a}),98);
__d("WABridgeBatcher",["WAShiftTimer"],(function(a,b,c,d,e,f,g){var h=20,i=1e3;a=function(){function a(a,b){var c=this;this.$1=null;this.$4=h;this.$5=Date.now();this.$6=new(d("WAShiftTimer").ShiftTimer)(function(){var a=c.$1;if(a==null)return;c.$1=null;c.$2(a)});this.$2=b;this.$3=a}var b=a.prototype;b.addEvent=function(a){var b=this.$1;this.$1=b?this.$3(b,a):[a];if(this.$6.isScheduled())return;b=this.$4;if(b<1){a=Date.now();var c=Math.max(a-this.$5,0)/i;b=Math.min(b+c,h);this.$4=b;this.$5=a}b>=1?(c=0,this.$4=b-1):(c=Math.ceil(i*(1-b)),this.$4=0);this.$6.onOrBefore(c)};b.cancel=function(){this.$1=null,this.$6.cancel()};return a}();g.BridgeBatcher=a}),98);
__d("WAPromiseCallSync",["Promise"],(function(a,b,c,d,e,f){function a(a,c){try{for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return b("Promise").resolve(a.apply(c,e))}catch(a){return b("Promise").reject(a)}}f.promiseCallSync=a}),66);
__d("WAPromiseManagement",["WAPromiseCallSync"],(function(a,b,c,d,e,f,g){function a(a){var b=null,c=function(){b||(b=d("WAPromiseCallSync").promiseCallSync(a)["finally"](function(){b=null}));return b};c.isPending=function(){return!!b};return c}function b(a,b){var c=new Map();return function(d){var e=a(d),f=c.get(e);if(f)return f;try{f=Promise.resolve(b(d))}catch(a){f=Promise.reject(a)}d=f["finally"](function(){return void c["delete"](e)});c.set(e,d);return d}}var h=new Set();function c(a){h.add(a),a["finally"](function(){h["delete"](a)})}g.nullaryCacheWhilePending=a;g.cacheWhilePending=b;g.preventGarbageCollection=c}),98);
__d("WACrossWorkerPortal",["Promise","WABridgeBatcher","WAErr","WALogger","WAPromiseManagement"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["absorbPortal: transferring request #",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected non-result to call"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected result to cast"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unrecognized result ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," response of ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," request for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge queuing "," msgs"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge sending "," across (delayed)"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge received msg on old port"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge updating port"]);q=function(){return a};return a}var r=function(){function a(a,b,c){var e=this;this.port=null;this.$2=1;this.openRequests=new Map();this.listeners=new Set();this.$1=a;this.sendStream=new(d("WABridgeBatcher").BridgeBatcher)(b,function(a){e.$3(a)});c.forEach(function(b){a.setNamespaceHandler(b,e.$4(b))})}var e=a.prototype;e.addListener=function(a){var b=this;this.listeners.add(a);return function(){return b.listeners["delete"](a)}};e.setPort=function(a){var b=this;d("WALogger").LOG(q());this.port=a;this.sendStream.cancel();a.onmessage=function(c){if(b.port!==a){d("WALogger").WARN(p()).devConsole(c.data);return}c=c.data;if(!c)return;c.forEach(function(c){b.$5(c,"incoming"),b.$6(a,c)})};this.openRequests.forEach(function(a){a=a.request;d("WALogger").LOG(o(),a.name);b.sendStream.addEvent({type:"request",content:a})})};e.getBridge=function(){return this.$1};e.$4=function(a){var b=this;return function(c,d,e,f){b.$7(a,c,d,e,f)}};e.$7=function(a,b,c,d,e){var f=this.$2++;a={requestId:f,expectsResponse:!!d,namespace:a,name:b,arg:c,silentLog:e};this.openRequests.set(f,{request:a,resolver:d});this.sendStream.addEvent({type:"request",content:a})};e.$8=function(a,b){if(a!==this.port)return;this.sendStream.addEvent({type:"result",content:b})};e.$3=function(a){var b=this,c=this.port;if(!c){d("WALogger").LOG(n(),a.length);return}c.postMessage(a);a.forEach(function(a){return b.$5(a,"outgoing")})};e.$5=function(a,b){this.listeners.forEach(function(c){return c(a,b)})};e.$6=function(a,e){var f=this;if(e.type==="request"){var g=e.content,h=g.namespace,n=g.name,o=g.requestId,p=g.arg,q=g.expectsResponse,r=g.silentLog;r||d("WALogger").LOG(m(),o,n);g=this.$1;if(q){q=g.sendAndReceive(h,n,p,r).then(function(b){f.$8(a,{requestId:o,type:"success",result:b,silentLog:r})},function(b){f.$8(a,{requestId:o,type:"error",result:String(b),silentLog:r})});d("WAPromiseManagement").preventGarbageCollection(q)}else{g.fireAndForget(h,n,p,r);q={type:"result",content:{requestId:o,type:"handled",silentLog:r}};this.$5(q,"outgoing");a.postMessage([q])}}else{e.type;g=e.content;h=g.requestId;n=g.type;p=g.result;q=g.silentLog;q||d("WALogger").LOG(l(),h,n);e=this.openRequests.get(h);if(!e){d("WALogger").WARN(k(),h);return}switch(n){case"success":case"error":this.openRequests["delete"](h);g=e.resolver;g?g(n==="success"?p:b("Promise").reject(c("WAErr")(p))):d("WALogger").ERROR(j());break;case"handled":e.resolver?d("WALogger").ERROR(i()):this.openRequests["delete"](h);break}}};return a}();function a(a,b,c){return new r(a,c,b)}function e(a){var b;(b=a.port)==null?void 0:b.close();a.port=null;a.sendStream.cancel();b=a.openRequests;a.openRequests=new Map();var c=a.getBridge();b.forEach(function(a){var b=a.request;a=a.resolver;var e=b.namespace,f=b.name,g=b.arg,i=b.silentLog;d("WALogger").LOG(h(),b.requestId);a?a(c.sendAndReceive(e,f,g,i)):c.fireAndForget(e,f,g,i)})}g.CrossWorkerPortal=r;g.attachPortal=a;g.killPortalAndSendPendingToBridge=e}),98);
__d("WADevToolMessageChannel",[],(function(a,b,c,d,e,f){var g=new MessageChannel();a=function(){g=new MessageChannel();return g};b=function(){return g};f.createNewChannel=a;f.getMostRecentChannel=b}),66);
__d("MAWCommonSetupBridge",["CurrentUser","ErrorTransport","I64","LSDatabaseDeferred.bs","LSMessagingThreadAttributionType.re","MAWBridge","MAWChatJid.bs","MAWCurrentUser","MAWDBUsageMetrics","MAWDbMedia","MAWEBSwitch","MAWFrontendMediaUtils","MAWGating","MAWJobActions","MAWThreadCutover.bs","MWLogSend.bs","MessagingBackend.re","MessagingLoggingUtilsAttachmentTypeInt.re","MessagingThreadType.re","ODS","Promise","QPLEvent","QPLUserFlow","ReStore.bs","SendEventType.re","WACrossWorkerPortal","WADevToolMessageChannel","WADevToolsBridge","WADualSendMsgUtils","WAJids","cr:2036","err","gkx","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWMainThreadLogger").__setRef("MAWCommonSetupBridge"),i=c("gkx")("5444"),j=new Set([25312111,25299391,25311870,25308825]),k=new Map(),l=new Map([[d("MAWDbMedia").MEDIA_TYPE.IMAGE,c("MessagingLoggingUtilsAttachmentTypeInt.re").image],[d("MAWDbMedia").MEDIA_TYPE.VIDEO,c("MessagingLoggingUtilsAttachmentTypeInt.re").video],[d("MAWDbMedia").MEDIA_TYPE.GIF,c("MessagingLoggingUtilsAttachmentTypeInt.re").gif],[d("MAWDbMedia").MEDIA_TYPE.STICKER,c("MessagingLoggingUtilsAttachmentTypeInt.re").sticker],[d("MAWDbMedia").MEDIA_TYPE.PTT,c("MessagingLoggingUtilsAttachmentTypeInt.re").audio]]),m=new Set([25312150,25313100,25304093,1056840931,25299294]);function n(a,b){return a+"_"+b}function o(a,b,e){return d("LSDatabaseDeferred.bs").db.then(function(f){f=d("ReStore.bs").toGenericStorage(f);return d("MAWThreadCutover.bs").isCutoverSecureThreadFromChatJid(f,a).then(function(a){c("QPLUserFlow").addAnnotations(b,{bool:{isCutover:a}},{instanceKey:e})})})}var p={fbErrorProxy:function(a){d("ErrorTransport").log(a)},log:function(a){var b=a.context,c=a.logLevel,d=a.logString,e=a.tags;switch(c){case"log":h.onReadyImmediately(function(a){a=a.info;return a(d,b,e)});return;case"warn":h.onReadyImmediately(function(a){a=a.warn;return a(d,b,e)});return;case"logRestricted":h.onReadyImmediately(function(a){a=a.logRestricted;return a(d,b,e)});return;case"debug":break;case"error":break;default:break}},logError:function(a){var b=a.context,c=a.entriesToReport,d=a.framesToPop,e=a.logString,f=a.message,g=a.stack,i=a.tags;h.onReadyImmediately(function(a){a=a.logError;return a(e,b,i,f,g,d,c)})},odsBumpEntityKey:function(a){var b=a.amount,e=a.entity;a=a.key;d("ODS").bumpEntityKey(3185,e,a+"."+(c("CurrentUser").getAppID()||"unknown"),b)},onJobFinished:function(a){a.type==="createGroup"&&a.originalArgs.key!=null&&d("MAWJobActions").recentFinishedJobsCache.set(a.originalArgs.key,a.result);switch(a.type){case"sendMsg":case"sendMediaMsg":case"sendReactionMsg":case"sendXMAShareMsg":var b=a.originalArgs.chatJid,e=a.type==="sendXMAShareMsg"?a.originalArgs.xmaMsgExternalId:a.originalArgs.externalId;k.set(n(b,e),a.originalArgs)}if(a.type==="sendWrittenMsg"){b=a.originalArgs.protocolMsgId;e=b.chat;var f=b.externalId;b=n(e,f);e=k.get(b);k["delete"](b);if(a.result.type==="success"&&e!=null){var g=e.args,h=e.chatJid;b=e.file;a=g.reactToAuthor!=null;var i;a&&(i=g.reaction!=null?c("MessagingLoggingUtilsAttachmentTypeInt.re").reaction:c("MessagingLoggingUtilsAttachmentTypeInt.re").unsendReaction);e=g.specialTextSize!=null;b=b!=null?d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(b.type).mediaType:null;var j=(b=l.get(b))!=null?b:e?c("MessagingLoggingUtilsAttachmentTypeInt.re").like:a?i:c("MessagingLoggingUtilsAttachmentTypeInt.re").text,m=d("WAJids").switchOnMsgrChatJidType(h,{group:function(){return d("MessagingThreadType.re").secureMessageOverWaGroup},user:function(){return d("MessagingThreadType.re").secureMessageOverWaOneToOne}});c("promiseDone")(d("LSDatabaseDeferred.bs").db.then(function(a){var b=d("ReStore.bs").toGenericStorage(a);c("promiseDone")(d("MAWChatJid.bs").toThreadKey(b,h).then(function(a){d("MWLogSend.bs").log(b,a,m,f,[],d("I64").of_string(d("MAWCurrentUser").getID()),d("LSMessagingThreadAttributionType.re").unknown,j,g.quote!=null,d("SendEventType.re").sendAcknowledgement,d("MessagingBackend.re").whatsappInfra,d("I64").to_string(a),g==null?void 0:(a=g.ephemeralSetting)==null?void 0:a.ephemeralExpirationInSec,d("WADualSendMsgUtils").isDualSendJid(h)?["dst:8"]:void 0,void 0)}))}))}}},qplEvent:function(a){var e=a.action,f=a.annotations,g=a.event,h=a.instanceKey,k=a.nonTrackableAnnotations,l=a.timestamp;if(!c("CurrentUser").isEmployee()&&j.has(d("QPLEvent").getMarkerId(g)))return;var n=h||0;h=k==null?void 0:(a=k.string)==null?void 0:a.jid;k=h!=null?d("WAJids").validateChatJid(h):void 0;a=m.has(d("QPLEvent").getMarkerId(g))&&k!=null?o(k,g,n):b("Promise").resolve();switch(e.type){case"start":c("QPLUserFlow").start(g,{annotations:babelHelpers["extends"]({},f||{},{bool:babelHelpers["extends"]({},(f==null?void 0:f.bool)||{},{isBulkifyHIMEnabled:d("MAWGating").isBulkifyHIMEnabled(),isDev:0,isDeviceRegistrationDomainUniquenessEnabled:d("MAWGating").isDeviceRegistrationDomainUniquenessEnabled(),isEBEnabled:c("MAWEBSwitch").isEnabled(),isGifSearchEnbled:d("MAWGating").isGifSearchEnabled(),isOccamadillo:d("MAWGating").isOccamadillo(),isTlcPublicUser:d("MAWGating").isTlcPublicUser(),stanzaQueue:d("MAWGating").enableRawStanzaQueueStore()})}),instanceKey:n,timestamp:l});break;case"success":if(i){h=d("MAWDBUsageMetrics").getMAWDBUsageMetrics();k=(k=h==null?void 0:(k=h.usageDetails)==null?void 0:k.indexedDB)!=null?k:h==null?void 0:h.usage;k!=null&&c("QPLUserFlow").addAnnotations(g,{"int":{indexedDbSizeInBytes:k}},{instanceKey:n})}c("QPLUserFlow").addAnnotations(g,{bool:{isRelaxedDurability:!0}},{instanceKey:n});a["finally"](function(){c("QPLUserFlow").endSuccess(g,{annotations:f,instanceKey:n,timestamp:l})});break;case"point":c("QPLUserFlow").addPoint(g,e.name,{data:f,instanceKey:n,timestamp:l});break;case"failure":c("QPLUserFlow").addAnnotations(g,{bool:{isRelaxedDurability:!0}},{instanceKey:n});a["finally"](function(){c("QPLUserFlow").endFailure(g,e.name,{annotations:f,instanceKey:n,timestamp:l})});break;default:throw c("err")("Bridge sends unreachable qplEvent action type")}}},q=function(a,b){a.push(b);return a};a=function(a){var e=a.customizeEventHandlers;a=a.worker;var f=d("MAWBridge").getBridge();f.setHandlers("event",babelHelpers["extends"]({},p,e));e=d("WACrossWorkerPortal").attachPortal(f,["backend"],q);e.setPort(a);if(c("gkx")("5147")){var g=d("WADevToolsBridge").getDevToolBridge();a=new MessageChannel();var h=d("WACrossWorkerPortal").attachPortal(g,["backend"],q),i=d("WACrossWorkerPortal").attachPortal(g,["devtool"],q);h.setPort(d("WADevToolMessageChannel").getMostRecentChannel().port1);i.setPort(a.port1);b("cr:2036")==null?void 0:b("cr:2036").connectAddonPort(a.port2);e.addListener(function(a,b){return g.fireAndForget("devtool","bridgeMessage",{direction:b==="outgoing"?"toWorker":"toMain",msg:a,ts:Date.now()},!0)})}return b("Promise").resolve(f)};g.commonBridgeEventHandlers=p;g.initBridge=a}),98);
__d("MAWSetupBridge",["LSDatabaseDeferred.bs","LSInitSyncCompleteSubscription.bs","MAWBridgeUIEventHandler.re","MAWBridgeUIEventsWrapper","MAWCommonSetupBridge","MAWCryptoAuthToken","MAWMainThreadLogger","Run","cr:1265","regeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("ArmadilloCutoverClientFalcoEvent").__setRef("MAWSetupBridge"),i=c("requireDeferred")("MAWSetupBridgeOfflineSnapshot").__setRef("MAWSetupBridge"),j=d("LSDatabaseDeferred.bs").db.then(d("LSInitSyncCompleteSubscription.bs").use).then(function(){return d("LSDatabaseDeferred.bs").db}),k=function(a){h.loadImmediately(function(b){b=b.log;return b(function(){return{armadillo_thread_id:a.armadilloThreadId,domain:a.domain,event:a.event,event_details:a.eventDetails,open_thread_id:a.openThreadId,success:a.success,trace_id:a.traceId}})})};function a(a){var c=a.dispatch,e=a.environment,f=a.logout,g=a.worker;function h(){g.postMessage({type:"force-flush-data"})}d("Run").onUnload(h);d("Run").onBeforeUnload(h,!1);return d("MAWCommonSetupBridge").initBridge({customizeEventHandlers:{flushLogs:function(a){return d("MAWMainThreadLogger").logToHistoryInBulk(a.logs)},logCutoverEvent:k,logout:f,offlineSnapshot:function(){var a=arguments;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(i.load());case 2:c.t0=void 0;c.t1=a;return c.abrupt("return",c.sent.apply(c.t0,c.t1));case 5:case"end":return c.stop()}},null,this)},rotateCryptoAuthToken:function(){return d("MAWCryptoAuthToken").fetchFreshCAT(e)},uiUpdate:function(a){a=a.events;c&&a.forEach(function(a){return c(a)});b("cr:1265")==null?void 0:b("cr:1265").recordBridgeUIEvent(a);d("MAWBridgeUIEventHandler.re").handleEvents(j,a.map(d("MAWBridgeUIEventsWrapper").UIEventToRE))}},worker:g})}g.setupBridge=a}),98);
__d("WorkerBanzaiLazyQueueChannelClient",["BanzaiLazyQueue","WorkerFuncChannel","qex"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("qex")._("844"),d("WorkerFuncChannel").exportChannel(c("BanzaiLazyQueue"),a,"banzai_lazyqueue_channel")}g.init=a}),98);
__d("WorkerQPLChannel",["WorkerFuncChannel","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("WorkerFuncChannel").WorkerFuncChannel)(function(a){return{markerStartFromNavStart:null,markerStart:function(b,d,e){e===void 0&&(e=c("performanceAbsoluteNow")());return a.markerStart(b,d,e)},markerAnnotate:function(b,c,d){return a.markerAnnotate(b,c,d)},markerPoint:function(b,d,e){e=(e==null?void 0:e.timestamp)===void 0?babelHelpers["extends"]({},e,{timestamp:c("performanceAbsoluteNow")()}):e;return a.markerPoint(b,d,e)},markerEnd:function(b,d,e,f){f===void 0&&(f=c("performanceAbsoluteNow")());return a.markerEnd(b,d,e,f)}}},"qpl");function a(a){h.setMessagePort(a)}function b(a){h.setBackend(a)}g.setMessagePort=a;g.initQPL=b}),98);
__d("WorkerClient",["WorkerBanzaiLazyQueueChannelClient","WorkerFuncChannel","WorkerQPLChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").activateChannels(a,"client","worker"),d("WorkerBanzaiLazyQueueChannelClient").init(a),d("WorkerQPLChannel").setMessagePort(a),e(["QuickPerformanceLogger"],function(a){return d("WorkerQPLChannel").initQPL(a)})}g.init=a}),98);
__d("MAWCommonSetupWorker",["MAWCommonSetupUser","MAWMainThreadLogger","Promise","WADevToolMessageChannel","WALogger","WorkerClient","WorkerMessagePort","err","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker receive invalid message: ",""]);h=function(){return a};return a}e=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;e=a.call(this,b,c)||this;e.onmessage=null;e.$BridgeAdapter1=b;d("WorkerClient").init(babelHelpers.assertThisInitialized(e));e.onUnhandledMessage.add(function(a){e.onmessage&&e.onmessage({data:a})});return e}var c=b.prototype;c.getBridgePort=function(){return this};return b}(d("WorkerMessagePort").WorkerSyncedMessagePort);function a(a,e,f,g){return new(b("Promise"))(function(b,i){a.addMessageListener("worker-setup",function(e){var f;e.status==="failure"&&((f=e.logs)==null?void 0:f.length)&&d("MAWMainThreadLogger").logToHistoryInBulk(e.logs);if(e==null||e.type!=="worker-setup"){d("WALogger").WARN(h(),e);return}if(e.status==="success")b(a.getBridgePort());else if(e.status==="failure"){i(c("err")((f=e.msg)!=null?f:"Encountered an error setting up the armadillo web worker"))}else throw c("err")("received invalid message for worker")});var j=d("MAWCommonSetupUser").getCurrentUserForArmadilloSetup_DO_NOT_USE(),k=window.location.hostname;if(c("gkx")("5147")){var l=d("WADevToolMessageChannel").createNewChannel();a.postMessage({content:{currentUser:j,devToolMessageChannelPort2:l.port2,fbId:e,hostname:k,latestKeyVersionForEAR:f,vaultMaterials:g},type:"worker-setup"},[l.port2])}else a.postMessage({content:{currentUser:j,fbId:e,hostname:k,latestKeyVersionForEAR:f,vaultMaterials:g},type:"worker-setup"})})}g.BridgeAdapter=e;g.initWorker=a}),98);
__d("MAWSetupWorker",["MAWCommonSetupWorker","MAWInit","MAWWebWorkerSingleton","Promise","WALogger","cr:3087","err","regeneratorRuntime","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker terminating"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker doesn't exist, no need to terminate"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker setting up"]);j=function(){return a};return a}var k=null,l=d("MAWWebWorkerSingleton").createWorkerIfNone(),m=null;function n(a,b,e){d("MAWInit").logPoint("create_worker_start");l=d("MAWWebWorkerSingleton").createWorkerIfNone();d("MAWInit").logPoint("create_worker_end");if(l===null)throw c("err")("Client is starting bridge without a worker.");d("WALogger").LOG(j());var f=new(d("MAWCommonSetupWorker").BridgeAdapter)(l,"MAWMainWorker");k=f;return d("MAWInit").measurePerformance("maw_init_worker",function(){return d("MAWCommonSetupWorker").initWorker(f,a,b,e)})}function a(a,c,d,e){if(!k){a=n(a,c,d);b("cr:3087")!=null&&(m=b("cr:3087")(e));return a}return b("Promise").resolve(k.getBridgePort())}function e(){return l!=null}function f(){if(!k){d("WALogger").LOG(i());return}d("WALogger").LOG(h());k.close();k=null;d("MAWWebWorkerSingleton").destroyWorkerInstance();l=null;m!=null&&m();m=null;return}function o(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(k){a.next=2;break}return a.abrupt("return");case 2:k.close();k=null;d("MAWWebWorkerSingleton").destroyWorkerInstance();l=null;a.next=8;return b("regeneratorRuntime").awrap(p(45e3));case 8:return a.abrupt("return");case 9:case"end":return a.stop()}},null,this)}function p(a){return new(b("Promise"))(function(b){return c("setTimeout")(b,a)})}g.setupWorker=n;g.getOrSetupWorker=a;g.doesWorkerExist=e;g.terminateWorker=f;g.killWorkerForTest=o}),98);
__d("MAWSetup.react",["BaseHeadingContext","CometPlaceholder.react","CometRelay","CurrentUser","MAWCommonSetup","MAWSetupBridge","MAWSetupWorker","MWChatEncryptedBackupsTrackRestoreWrapper.react","cr:127","cr:2808","cr:2809","cr:3487","cr:3663","cr:5015","cr:5284","cr:5285","deferredLoadComponent","promiseDone","react","requireDeferredForDisplay","shouldUseMAWSharedWorker","useCometLogout","useReStore","useSecretConversationsLogOut"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");e=d("react");var i=e.useContext,j=e.useMemo,k=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MAWLoadingStateSpinner.react").__setRef("MAWSetup.react"));window.XPlatTesting=b("cr:2808");window.XPlatTestingGroups=b("cr:2809");var l=c("CurrentUser").getID();function m(a){var e=d("CometRelay").useRelayEnvironment(),f=c("useReStore")(),g=c("useSecretConversationsLogOut")(),i=j(function(){return function(){return c("promiseDone")(g())}},[g]),k=j(function(){return{doesWorkerExist:d("MAWSetupWorker").doesWorkerExist,getOrSetupWorker:d("MAWSetupWorker").getOrSetupWorker,logout:i,setupBridge:d("MAWSetupBridge").setupBridge,terminateWorker:d("MAWSetupWorker").terminateWorker}},[i]);d("MAWCommonSetup").useArmadillo(l,k);b("cr:5284")!=null?b("cr:5284")==null?void 0:b("cr:5284").makeAll(f):b("cr:5285")==null?void 0:b("cr:5285").useMAWContactSync();b("cr:3663")(f);b("cr:127")();return h.jsxs(h.Fragment,{children:[a.children,!c("shouldUseMAWSharedWorker")()&&b("cr:5015")?h.jsx(b("cr:5015"),{environment:e,fbId:l,platformSetupUtils:k}):null]})}m.displayName=m.name+" [from "+f.id+"]";function a(a){var e=i(c("BaseHeadingContext"));return h.jsx(d("useCometLogout").CometLogoutProvider,{children:h.jsxs(c("BaseHeadingContext").Provider,{value:e+1,children:[h.jsx(m,babelHelpers["extends"]({},a)),h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(k,{})}),b("cr:3487")&&h.jsx(b("cr:3487"),{}),h.jsx(c("MWChatEncryptedBackupsTrackRestoreWrapper.react"),{})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWSetupMutex.react",["cr:2671","react"],(function(a,b,c,d,e,f,g){"use strict";d("react");function a(a){var c=a.environment,d=a.fbId;a=a.platformSetupUtils;b("cr:2671").useMutex(c,d,a);return null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWSetupMutexV2",["FBLogger","LSPersistedDbGating","LocalStorageMutex","MAWAppMutex","MAWBridge","MAWEncyptionIndexedDbV2","MAWGating","MAWIndexedDb","MAWKeychainInit","MAWKeychainV2","MAWLocalStorage","MAWOccamadilloOnMutexChange","MAWStateContext.react","MAWVaultMaterialsStorage","MWChatBadgeCountUpdates.bs","QPLUserCountEvent","QPLUserFlow","Run","WALogger","qex","qpl","react","regeneratorRuntime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Reinitializing"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Shouldn't reinitialize, worker already exists"]);i=function(){return a};return a}a=d("react");var j=a.useCallback,k=a.useEffect,l=a.useMemo,m=c("FBLogger")("messenger_e2ee_web"),n=!1,o=0;function p(a){if(document.visibilityState!=="visible")return!1;a=a();var b=window.indexedDB!=null,e=d("MAWLocalStorage").isLocalStorageAvailable();if(a){d("WALogger").DEV(i());return!1}if(!b){d("QPLUserCountEvent").fireQplUserCount(c("qpl")._(25299354,"201"));return!1}if(!e){d("QPLUserCountEvent").fireQplUserCount(c("qpl")._(25309925,"203"));return!1}return!0}function q(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("MAWEncyptionIndexedDbV2").makeEncryptionDB(a));case 2:return c.abrupt("return",d("MAWKeychainInit").initSetupKeychain());case 3:case"end":return c.stop()}},null,this)}function r(){return d("MAWVaultMaterialsStorage").setupVaultMaterials()}e=function(a,e,f){var g=f.doesWorkerExist,i=f.getOrSetupWorker,s=f.logout,t=f.setupBridge,u=f.terminateWorker,v=l(function(){return d("MAWAppMutex").use()},[]),w=c("useReStore")(),x=d("MAWStateContext.react").useDispatchClearEphemeralSettings(),y=d("LSPersistedDbGating").allTablesPersisted,z=j(function(a){var b=v.takeoverFilter(a);if(!b||a.newValue===d("LocalStorageMutex").THIS_TAB||a.newValue==="")return;y||d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"DropAllSecureThreads",value:void 0}]});u();v.onMutexDeath()},[v,y,u]),A=j(function(){u(),v.onMutexDeath()},[v,u]),B=j(function(){var f,j,k,l,u,z;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:f=p(g);if(!(!f||n||c("qex")._("215")===!0)){A.next=3;break}return A.abrupt("return");case 3:n=!0;o++;A.prev=5;d("WALogger").LOG(h());c("QPLUserFlow").start(c("qpl")._(25310984,"169"),{instanceKey:o});c("QPLUserFlow").addAnnotations(c("qpl")._(25310984,"169"),{"int":{version:2}},{instanceKey:o});A.next=11;return b("regeneratorRuntime").awrap(v.init());case 11:j=A.sent;if(j){A.next=15;break}c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"mutex_no_premission_on_reinit",{instanceKey:o});return A.abrupt("return");case 15:A.next=17;return b("regeneratorRuntime").awrap(q(e));case 17:k=A.sent;if(k.success){A.next=21;break}c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"mutex_keychain_setup_failure_on_reinit",{instanceKey:o});return A.abrupt("return");case 21:A.next=23;return b("regeneratorRuntime").awrap(d("MAWIndexedDb").makeDB(e,d("MAWKeychainV2").getDbEncryptionKey));case 23:c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"db_init",{instanceKey:o});A.next=26;return b("regeneratorRuntime").awrap(r());case 26:l=A.sent;c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"vaulting_setup",{instanceKey:o});c("QPLUserFlow").addAnnotations(c("qpl")._(25310984,"169"),{bool:{will_vault:l!=null}},{instanceKey:o});A.next=31;return b("regeneratorRuntime").awrap(i(e,k.value,l,w));case 31:u=A.sent;c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"worker_setup",{instanceKey:o});A.next=35;return b("regeneratorRuntime").awrap(t({environment:a,logout:s,worker:u}));case 35:z=A.sent;c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"bridge_setup",{instanceKey:o});if(!(!y&&d("MAWGating").isOccamadillo())){A.next=41;break}d("MAWOccamadilloOnMutexChange").onOccamadilloMutexChange(w);A.next=44;break;case 41:if(y){A.next=44;break}A.next=44;return b("regeneratorRuntime").awrap(z.sendAndReceive("backend","initSync",{numMsgsPerThread:10,numThreads:d("MWChatBadgeCountUpdates.bs").minSyncedThreads}));case 44:c("QPLUserFlow").endSuccess(c("qpl")._(25310984,"169"),{instanceKey:o});x();A.next=53;break;case 48:A.prev=48,A.t0=A["catch"](5),m.mustfix("AppMutex - failed to reinitialize worker"),m.catching(A.t0),c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"failed_to_reinitialize_worker",{error:A.t0,instanceKey:o});case 53:A.prev=53;n=!1;return A.finish(53);case 56:case"end":return A.stop()}},null,this,[[5,48,53,56]])},[g,v,e,i,w,t,a,s,y,x]);k(function(){window.addEventListener("storage",z);var a=d("Run").onBeforeUnload(A,!1),b=d("Run").onUnload(A);window.addEventListener("visibilitychange",B);return function(){window.removeEventListener("storage",z),a.remove(),b.remove(),window.removeEventListener("visibilitychange",B)}},[z,A,B])};g.useMutex=e}),98);
__d("useMAWOfflineQueueStateForToast",["gkx","react","useCurrentRoute","useMAWOfflineQueueState"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useEffect,i=b.useState;function a(){var a,b=c("useMAWOfflineQueueState")(),d=(a=c("useCurrentRoute")())==null?void 0:a.tabKey;a=i(d==="messenger");var e=a[0],f=a[1];h(function(){!e&&d==="messenger"&&f(!0)},[e,d]);return c("gkx")("571")||e?b:!1}g["default"]=a}),98);
__d("MAWLoadingStateSpinner.react",["fbt","ix","BaseToasterStateManager","CometIcon.react","CometProgressRingDeterminate.react","MAWStateContext.react","fbicon","mwPushToast","mwReplaceToast","react","useMAWOfflineQueueStateForToast"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");b=d("react");e=b.memo;var k=b.useContext,l=b.useEffect,m=b.useMemo,n=b.useRef,o=h._("__JHASH__f9ft1Nb-b3f__JHASH__"),p=h._("__JHASH__laOwOEc4JeD__JHASH__"),q=function(a,b){return h._("__JHASH__-uoxDFsOMfK__JHASH__",[h._param("restoredMessage",a.toString()),h._param("count",b.toString())])},r=c("BaseToasterStateManager").getInstance();function s(a,b){var d=100*a/b;a=b>100?q(a,b):void 0;return{body:a,icon:{comet:j.jsx(c("CometProgressRingDeterminate.react"),{color:"light",percentage:d,size:20})},startAddOn:{source:d,type:"progressRing"},title:o}}function t(a){d("mwReplaceToast").mwReplaceToast({icon:{comet:j.jsx(c("CometIcon.react"),{icon:d("fbicon")._(i("498146"),20)}),mds:d("fbicon")._(i("477815"),24)},title:p,toastId:a})}function a(){var a=c("useMAWOfflineQueueStateForToast")(),b=k(d("MAWStateContext.react").MAWStateContext).state,e=b.offlineQueueCount,f=b.offlineQueueProgressDownloaded,g=n();m(function(){if(a)g.current==null?g.current=d("mwPushToast").mwPushToast(s(f,e),Number.MAX_SAFE_INTEGER):d("mwReplaceToast").mwReplaceToast(babelHelpers["extends"]({},s(f,e),{toastId:g.current}));else if(g.current!=null){var b=g.current;t(b);window.setTimeout(function(){r.expire(b),g.current=void 0},2750)}},[a,f,e]);l(function(){return function(){g.current!=null&&r.expire(g.current)}},[]);return null}a.displayName=a.name+" [from "+f.id+"]";b=e(a);g["default"]=b}),98);